2023-05-05 04:55:48.838100: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:48.838146: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-05-05 04:55:50.934780: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-05 04:55:50.935687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-05 04:55:50.970796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: RTX A5000 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 64 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 715.34GiB/s
2023-05-05 04:55:50.970903: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.971308: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcublas.so.11'; dlerror: libcublas.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.971783: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcublasLt.so.11'; dlerror: libcublasLt.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.972123: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.972479: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.972815: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.973171: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusparse.so.11'; dlerror: libcusparse.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.973504: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/opt/oracle/instantclient_19_8:/p/cuda-11.5
2023-05-05 04:55:50.973798: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2023-05-05 04:55:50.974592: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-05 04:55:50.977154: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-05 04:55:50.977189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-05 04:55:50.977196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2023-05-05 04:55:51.139296: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-05 04:55:51.139837: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3700340000 Hz
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
539/539 - 4s - loss: 0.1306 - accuracy: 0.9568 - auc: 0.9901 - recall: 0.9622 - precision: 0.9522 - val_loss: 0.0745 - val_accuracy: 0.9749 - val_auc: 0.9952 - val_recall: 0.9893 - val_precision: 0.9605
Epoch 2/20
539/539 - 1s - loss: 0.0639 - accuracy: 0.9761 - auc: 0.9969 - recall: 0.9866 - precision: 0.9664 - val_loss: 0.0679 - val_accuracy: 0.9791 - val_auc: 0.9967 - val_recall: 0.9786 - val_precision: 0.9786
Epoch 3/20
539/539 - 1s - loss: 0.0557 - accuracy: 0.9789 - auc: 0.9975 - recall: 0.9888 - precision: 0.9698 - val_loss: 0.0564 - val_accuracy: 0.9786 - val_auc: 0.9974 - val_recall: 0.9850 - val_precision: 0.9715
Epoch 4/20
539/539 - 1s - loss: 0.0510 - accuracy: 0.9810 - auc: 0.9977 - recall: 0.9912 - precision: 0.9715 - val_loss: 0.0619 - val_accuracy: 0.9744 - val_auc: 0.9970 - val_recall: 0.9743 - val_precision: 0.9733
Epoch 5/20
539/539 - 1s - loss: 0.0498 - accuracy: 0.9810 - auc: 0.9978 - recall: 0.9910 - precision: 0.9716 - val_loss: 0.0536 - val_accuracy: 0.9812 - val_auc: 0.9974 - val_recall: 0.9957 - val_precision: 0.9668
Epoch 6/20
539/539 - 1s - loss: 0.0480 - accuracy: 0.9814 - auc: 0.9982 - recall: 0.9918 - precision: 0.9718 - val_loss: 0.0448 - val_accuracy: 0.9812 - val_auc: 0.9984 - val_recall: 0.9893 - val_precision: 0.9727
Epoch 7/20
539/539 - 1s - loss: 0.0454 - accuracy: 0.9817 - auc: 0.9984 - recall: 0.9917 - precision: 0.9724 - val_loss: 0.0511 - val_accuracy: 0.9781 - val_auc: 0.9978 - val_recall: 0.9754 - val_precision: 0.9796
Epoch 8/20
539/539 - 1s - loss: 0.0444 - accuracy: 0.9825 - auc: 0.9984 - recall: 0.9914 - precision: 0.9742 - val_loss: 0.0532 - val_accuracy: 0.9765 - val_auc: 0.9977 - val_recall: 0.9807 - val_precision: 0.9714
Epoch 9/20
539/539 - 1s - loss: 0.0423 - accuracy: 0.9831 - auc: 0.9986 - recall: 0.9909 - precision: 0.9758 - val_loss: 0.0468 - val_accuracy: 0.9843 - val_auc: 0.9979 - val_recall: 0.9957 - val_precision: 0.9728
Epoch 10/20
539/539 - 1s - loss: 0.0424 - accuracy: 0.9833 - auc: 0.9985 - recall: 0.9919 - precision: 0.9753 - val_loss: 0.0406 - val_accuracy: 0.9864 - val_auc: 0.9983 - val_recall: 0.9947 - val_precision: 0.9779
Epoch 11/20
539/539 - 1s - loss: 0.0418 - accuracy: 0.9833 - auc: 0.9985 - recall: 0.9927 - precision: 0.9744 - val_loss: 0.0396 - val_accuracy: 0.9849 - val_auc: 0.9984 - val_recall: 0.9936 - val_precision: 0.9758
Epoch 12/20
539/539 - 1s - loss: 0.0415 - accuracy: 0.9845 - auc: 0.9985 - recall: 0.9929 - precision: 0.9766 - val_loss: 0.0383 - val_accuracy: 0.9859 - val_auc: 0.9985 - val_recall: 0.9979 - val_precision: 0.9739
Epoch 13/20
539/539 - 1s - loss: 0.0394 - accuracy: 0.9845 - auc: 0.9987 - recall: 0.9929 - precision: 0.9764 - val_loss: 0.0405 - val_accuracy: 0.9843 - val_auc: 0.9988 - val_recall: 0.9936 - val_precision: 0.9748
Epoch 14/20
539/539 - 1s - loss: 0.0388 - accuracy: 0.9852 - auc: 0.9987 - recall: 0.9939 - precision: 0.9770 - val_loss: 0.0356 - val_accuracy: 0.9870 - val_auc: 0.9990 - val_recall: 0.9968 - val_precision: 0.9769
Epoch 15/20
539/539 - 1s - loss: 0.0378 - accuracy: 0.9858 - auc: 0.9987 - recall: 0.9934 - precision: 0.9787 - val_loss: 0.0399 - val_accuracy: 0.9849 - val_auc: 0.9983 - val_recall: 0.9947 - val_precision: 0.9748
Epoch 16/20
539/539 - 1s - loss: 0.0380 - accuracy: 0.9855 - auc: 0.9988 - recall: 0.9928 - precision: 0.9786 - val_loss: 0.0398 - val_accuracy: 0.9854 - val_auc: 0.9989 - val_recall: 0.9914 - val_precision: 0.9789
Epoch 17/20
539/539 - 1s - loss: 0.0365 - accuracy: 0.9868 - auc: 0.9989 - recall: 0.9944 - precision: 0.9796 - val_loss: 0.0389 - val_accuracy: 0.9854 - val_auc: 0.9985 - val_recall: 0.9957 - val_precision: 0.9749
Epoch 18/20
539/539 - 1s - loss: 0.0354 - accuracy: 0.9865 - auc: 0.9989 - recall: 0.9935 - precision: 0.9798 - val_loss: 0.0317 - val_accuracy: 0.9890 - val_auc: 0.9993 - val_recall: 0.9957 - val_precision: 0.9821
Epoch 19/20
539/539 - 1s - loss: 0.0359 - accuracy: 0.9868 - auc: 0.9989 - recall: 0.9933 - precision: 0.9807 - val_loss: 0.0346 - val_accuracy: 0.9890 - val_auc: 0.9991 - val_recall: 0.9947 - val_precision: 0.9831
Epoch 20/20
539/539 - 1s - loss: 0.0343 - accuracy: 0.9864 - auc: 0.9991 - recall: 0.9931 - precision: 0.9801 - val_loss: 0.0355 - val_accuracy: 0.9828 - val_auc: 0.9986 - val_recall: 0.9840 - val_precision: 0.9808
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
Metrics: 
 {'auc': 0.9359444543350544, 'accuracy': 0.9851169383416017, 'precision': 0.6807228915662651, 'recall': 0.9186991869918699, 'f1': 0.7820069204152249, 'fp': 53, 'tp': 113, 'fn': 10, 'tn': 4057, 'auprc': 0.9157269000393357, 'precision99': 0.93, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
406/406 - 4s - loss: 0.3482 - accuracy: 0.8674 - auc_1: 0.8924 - recall_1: 0.9892 - precision_1: 0.7954 - val_loss: 0.2954 - val_accuracy: 0.8813 - val_auc_1: 0.9030 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 2/20
406/406 - 1s - loss: 0.2988 - accuracy: 0.8786 - auc_1: 0.9020 - recall_1: 0.9958 - precision_1: 0.8066 - val_loss: 0.2999 - val_accuracy: 0.8813 - val_auc_1: 0.9028 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 3/20
406/406 - 1s - loss: 0.2970 - accuracy: 0.8786 - auc_1: 0.9063 - recall_1: 0.9958 - precision_1: 0.8066 - val_loss: 0.2967 - val_accuracy: 0.8820 - val_auc_1: 0.9028 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 4/20
406/406 - 1s - loss: 0.2959 - accuracy: 0.8786 - auc_1: 0.9042 - recall_1: 0.9958 - precision_1: 0.8066 - val_loss: 0.2997 - val_accuracy: 0.8813 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 5/20
406/406 - 1s - loss: 0.2964 - accuracy: 0.8786 - auc_1: 0.9047 - recall_1: 0.9958 - precision_1: 0.8066 - val_loss: 0.2972 - val_accuracy: 0.8820 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 6/20
406/406 - 1s - loss: 0.2946 - accuracy: 0.8789 - auc_1: 0.9044 - recall_1: 0.9966 - precision_1: 0.8068 - val_loss: 0.2942 - val_accuracy: 0.8813 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 7/20
406/406 - 1s - loss: 0.2944 - accuracy: 0.8791 - auc_1: 0.9030 - recall_1: 0.9969 - precision_1: 0.8068 - val_loss: 0.2962 - val_accuracy: 0.8813 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 8/20
406/406 - 1s - loss: 0.2940 - accuracy: 0.8789 - auc_1: 0.9011 - recall_1: 0.9966 - precision_1: 0.8068 - val_loss: 0.2935 - val_accuracy: 0.8813 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 9/20
406/406 - 1s - loss: 0.2937 - accuracy: 0.8792 - auc_1: 0.9031 - recall_1: 0.9972 - precision_1: 0.8068 - val_loss: 0.2941 - val_accuracy: 0.8820 - val_auc_1: 0.9029 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 10/20
406/406 - 1s - loss: 0.2932 - accuracy: 0.8793 - auc_1: 0.9022 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2964 - val_accuracy: 0.8820 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 11/20
406/406 - 1s - loss: 0.2929 - accuracy: 0.8793 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2954 - val_accuracy: 0.8820 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 12/20
406/406 - 1s - loss: 0.2922 - accuracy: 0.8793 - auc_1: 0.9046 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.3005 - val_accuracy: 0.8813 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 13/20
406/406 - 1s - loss: 0.2923 - accuracy: 0.8793 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2938 - val_accuracy: 0.8820 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 14/20
406/406 - 1s - loss: 0.2912 - accuracy: 0.8793 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2978 - val_accuracy: 0.8820 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 15/20
406/406 - 1s - loss: 0.2917 - accuracy: 0.8793 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2949 - val_accuracy: 0.8820 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 16/20
406/406 - 1s - loss: 0.2913 - accuracy: 0.8793 - auc_1: 0.9059 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2902 - val_accuracy: 0.8820 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 17/20
406/406 - 1s - loss: 0.2918 - accuracy: 0.8793 - auc_1: 0.9034 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2922 - val_accuracy: 0.8820 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 18/20
406/406 - 1s - loss: 0.2907 - accuracy: 0.8793 - auc_1: 0.9034 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2970 - val_accuracy: 0.8813 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 19/20
406/406 - 1s - loss: 0.2915 - accuracy: 0.8793 - auc_1: 0.9037 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2938 - val_accuracy: 0.8820 - val_auc_1: 0.9029 - val_recall_1: 0.9972 - val_precision_1: 0.8104
Epoch 20/20
406/406 - 1s - loss: 0.2913 - accuracy: 0.8793 - auc_1: 0.8998 - recall_1: 0.9974 - precision_1: 0.8069 - val_loss: 0.2910 - val_accuracy: 0.8820 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8104
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.9304958768764344, 'accuracy': 0.9648003779825183, 'precision': 0.9575, 'recall': 0.9957751056223595, 'f1': 0.9762625458021349, 'fp': 136, 'tp': 3064, 'fn': 13, 'tn': 1020, 'auprc': 0.9184512020919662, 'precision99': 0.77, 'recall99': 0.05}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 4s - loss: 0.3846 - accuracy: 0.8547 - auc_2: 0.8945 - recall_2: 0.8108 - precision_2: 0.8892 - val_loss: 0.3145 - val_accuracy: 0.8855 - val_auc_2: 0.9248 - val_recall_2: 0.8159 - val_precision_2: 0.9458
Epoch 2/20
558/558 - 1s - loss: 0.3006 - accuracy: 0.8855 - auc_2: 0.9246 - recall_2: 0.8182 - precision_2: 0.9456 - val_loss: 0.2829 - val_accuracy: 0.8951 - val_auc_2: 0.9306 - val_recall_2: 0.8220 - val_precision_2: 0.9608
Epoch 3/20
558/558 - 1s - loss: 0.2849 - accuracy: 0.8901 - auc_2: 0.9295 - recall_2: 0.8186 - precision_2: 0.9554 - val_loss: 0.2715 - val_accuracy: 0.8956 - val_auc_2: 0.9362 - val_recall_2: 0.8250 - val_precision_2: 0.9586
Epoch 4/20
558/558 - 1s - loss: 0.2805 - accuracy: 0.8924 - auc_2: 0.9317 - recall_2: 0.8204 - precision_2: 0.9585 - val_loss: 0.2725 - val_accuracy: 0.8961 - val_auc_2: 0.9352 - val_recall_2: 0.8281 - val_precision_2: 0.9565
Epoch 5/20
558/558 - 1s - loss: 0.2761 - accuracy: 0.8942 - auc_2: 0.9304 - recall_2: 0.8206 - precision_2: 0.9624 - val_loss: 0.2691 - val_accuracy: 0.8956 - val_auc_2: 0.9348 - val_recall_2: 0.8199 - val_precision_2: 0.9641
Epoch 6/20
558/558 - 1s - loss: 0.2726 - accuracy: 0.8944 - auc_2: 0.9326 - recall_2: 0.8203 - precision_2: 0.9633 - val_loss: 0.2672 - val_accuracy: 0.8996 - val_auc_2: 0.9350 - val_recall_2: 0.8271 - val_precision_2: 0.9656
Epoch 7/20
558/558 - 1s - loss: 0.2706 - accuracy: 0.8950 - auc_2: 0.9344 - recall_2: 0.8194 - precision_2: 0.9655 - val_loss: 0.2694 - val_accuracy: 0.8951 - val_auc_2: 0.9356 - val_recall_2: 0.8210 - val_precision_2: 0.9619
Epoch 8/20
558/558 - 1s - loss: 0.2704 - accuracy: 0.8954 - auc_2: 0.9333 - recall_2: 0.8199 - precision_2: 0.9659 - val_loss: 0.2619 - val_accuracy: 0.8981 - val_auc_2: 0.9369 - val_recall_2: 0.8301 - val_precision_2: 0.9589
Epoch 9/20
558/558 - 1s - loss: 0.2668 - accuracy: 0.8963 - auc_2: 0.9339 - recall_2: 0.8206 - precision_2: 0.9673 - val_loss: 0.2661 - val_accuracy: 0.9001 - val_auc_2: 0.9353 - val_recall_2: 0.8321 - val_precision_2: 0.9612
Epoch 10/20
558/558 - 1s - loss: 0.2649 - accuracy: 0.8970 - auc_2: 0.9346 - recall_2: 0.8210 - precision_2: 0.9683 - val_loss: 0.2558 - val_accuracy: 0.9006 - val_auc_2: 0.9379 - val_recall_2: 0.8281 - val_precision_2: 0.9667
Epoch 11/20
558/558 - 1s - loss: 0.2642 - accuracy: 0.8982 - auc_2: 0.9338 - recall_2: 0.8218 - precision_2: 0.9704 - val_loss: 0.2543 - val_accuracy: 0.9031 - val_auc_2: 0.9378 - val_recall_2: 0.8332 - val_precision_2: 0.9669
Epoch 12/20
558/558 - 1s - loss: 0.2629 - accuracy: 0.8982 - auc_2: 0.9333 - recall_2: 0.8218 - precision_2: 0.9704 - val_loss: 0.2656 - val_accuracy: 0.8996 - val_auc_2: 0.9361 - val_recall_2: 0.8321 - val_precision_2: 0.9601
Epoch 13/20
558/558 - 1s - loss: 0.2617 - accuracy: 0.8987 - auc_2: 0.9350 - recall_2: 0.8224 - precision_2: 0.9706 - val_loss: 0.2534 - val_accuracy: 0.9072 - val_auc_2: 0.9369 - val_recall_2: 0.8321 - val_precision_2: 0.9773
Epoch 14/20
558/558 - 1s - loss: 0.2625 - accuracy: 0.8977 - auc_2: 0.9355 - recall_2: 0.8210 - precision_2: 0.9701 - val_loss: 0.2549 - val_accuracy: 0.9041 - val_auc_2: 0.9380 - val_recall_2: 0.8321 - val_precision_2: 0.9703
Epoch 15/20
558/558 - 1s - loss: 0.2599 - accuracy: 0.8987 - auc_2: 0.9368 - recall_2: 0.8212 - precision_2: 0.9720 - val_loss: 0.2550 - val_accuracy: 0.9046 - val_auc_2: 0.9371 - val_recall_2: 0.8332 - val_precision_2: 0.9704
Epoch 16/20
558/558 - 1s - loss: 0.2584 - accuracy: 0.8995 - auc_2: 0.9352 - recall_2: 0.8227 - precision_2: 0.9722 - val_loss: 0.2498 - val_accuracy: 0.9041 - val_auc_2: 0.9393 - val_recall_2: 0.8250 - val_precision_2: 0.9783
Epoch 17/20
558/558 - 1s - loss: 0.2559 - accuracy: 0.9000 - auc_2: 0.9371 - recall_2: 0.8223 - precision_2: 0.9737 - val_loss: 0.2555 - val_accuracy: 0.9031 - val_auc_2: 0.9378 - val_recall_2: 0.8281 - val_precision_2: 0.9725
Epoch 18/20
558/558 - 1s - loss: 0.2559 - accuracy: 0.9005 - auc_2: 0.9370 - recall_2: 0.8227 - precision_2: 0.9745 - val_loss: 0.2525 - val_accuracy: 0.9031 - val_auc_2: 0.9350 - val_recall_2: 0.8179 - val_precision_2: 0.9841
Epoch 19/20
558/558 - 1s - loss: 0.2539 - accuracy: 0.9009 - auc_2: 0.9377 - recall_2: 0.8231 - precision_2: 0.9749 - val_loss: 0.2540 - val_accuracy: 0.9077 - val_auc_2: 0.9375 - val_recall_2: 0.8311 - val_precision_2: 0.9796
Epoch 20/20
558/558 - 1s - loss: 0.2540 - accuracy: 0.9006 - auc_2: 0.9366 - recall_2: 0.8222 - precision_2: 0.9753 - val_loss: 0.2444 - val_accuracy: 0.9097 - val_auc_2: 0.9401 - val_recall_2: 0.8311 - val_precision_2: 0.9843
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.04147744474719951
proportion of infection events tagged by ps-detector-recon detector:  0.4827934201231204
proportion of infection events tagged by ps-detector-infec detector:  0.4204258754667474
proportion of events estimated to be benign :  0.06872540115046927
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_6 (LSTM)                   [(None, 10, 128), (N 68096       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         lstm_6[0][1]                     
__________________________________________________________________________________________________
repeat_vector (RepeatVector)    (None, 10, 128)      0           batch_normalization[0][0]        
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128)          512         lstm_6[0][2]                     
__________________________________________________________________________________________________
lstm_7 (LSTM)                   (None, 10, 128)      131584      repeat_vector[0][0]              
                                                                 batch_normalization[0][0]        
                                                                 batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dot (Dot)                       (None, 10, 10)       0           lstm_7[0][0]                     
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 10, 10)       0           dot[0][0]                        
__________________________________________________________________________________________________
dot_1 (Dot)                     (None, 10, 128)      0           activation[0][0]                 
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 10, 128)      512         dot_1[0][0]                      
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 10, 256)      0           batch_normalization_2[0][0]      
                                                                 lstm_7[0][0]                     
__________________________________________________________________________________________________
time_distributed (TimeDistribut (None, 10, 1)        257         concatenate[0][0]                
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 10, 1)        0           time_distributed[0][0]           
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 10s - loss: 0.0559 - accuracy: 0.9848 - auc_3: 0.9954 - recall_3: 0.9849 - precision_3: 0.9848 - val_loss: 0.0359 - val_accuracy: 0.9923 - val_auc_3: 0.9977 - val_recall_3: 0.9911 - val_precision_3: 0.9934
Epoch 2/30
159/159 - 5s - loss: 0.0380 - accuracy: 0.9927 - auc_3: 0.9966 - recall_3: 0.9937 - precision_3: 0.9917 - val_loss: 0.0239 - val_accuracy: 0.9942 - val_auc_3: 0.9985 - val_recall_3: 0.9924 - val_precision_3: 0.9960
Epoch 3/30
159/159 - 5s - loss: 0.0318 - accuracy: 0.9931 - auc_3: 0.9970 - recall_3: 0.9927 - precision_3: 0.9935 - val_loss: 0.2524 - val_accuracy: 0.8716 - val_auc_3: 0.9974 - val_recall_3: 0.7450 - val_precision_3: 0.9977
Epoch 4/30
159/159 - 5s - loss: 0.0319 - accuracy: 0.9931 - auc_3: 0.9969 - recall_3: 0.9927 - precision_3: 0.9934 - val_loss: 0.0700 - val_accuracy: 0.9764 - val_auc_3: 0.9979 - val_recall_3: 0.9554 - val_precision_3: 0.9973
Epoch 5/30
159/159 - 5s - loss: 0.0301 - accuracy: 0.9934 - auc_3: 0.9974 - recall_3: 0.9928 - precision_3: 0.9941 - val_loss: 0.1469 - val_accuracy: 0.9437 - val_auc_3: 0.9971 - val_recall_3: 0.8886 - val_precision_3: 0.9988
Epoch 6/30
159/159 - 5s - loss: 0.0293 - accuracy: 0.9934 - auc_3: 0.9976 - recall_3: 0.9929 - precision_3: 0.9938 - val_loss: 0.0326 - val_accuracy: 0.9909 - val_auc_3: 0.9983 - val_recall_3: 0.9863 - val_precision_3: 0.9954
Epoch 7/30
159/159 - 5s - loss: 0.0288 - accuracy: 0.9937 - auc_3: 0.9975 - recall_3: 0.9929 - precision_3: 0.9945 - val_loss: 0.0364 - val_accuracy: 0.9927 - val_auc_3: 0.9979 - val_recall_3: 0.9904 - val_precision_3: 0.9950
Epoch 8/30
159/159 - 5s - loss: 0.0285 - accuracy: 0.9936 - auc_3: 0.9977 - recall_3: 0.9929 - precision_3: 0.9943 - val_loss: 0.0292 - val_accuracy: 0.9937 - val_auc_3: 0.9983 - val_recall_3: 0.9905 - val_precision_3: 0.9969
Epoch 9/30
159/159 - 5s - loss: 0.0305 - accuracy: 0.9932 - auc_3: 0.9976 - recall_3: 0.9925 - precision_3: 0.9939 - val_loss: 0.0349 - val_accuracy: 0.9912 - val_auc_3: 0.9982 - val_recall_3: 0.9862 - val_precision_3: 0.9962
Epoch 10/30
159/159 - 5s - loss: 0.0288 - accuracy: 0.9935 - auc_3: 0.9975 - recall_3: 0.9926 - precision_3: 0.9943 - val_loss: 0.0293 - val_accuracy: 0.9938 - val_auc_3: 0.9983 - val_recall_3: 0.9910 - val_precision_3: 0.9966
Epoch 11/30
159/159 - 5s - loss: 0.0277 - accuracy: 0.9937 - auc_3: 0.9977 - recall_3: 0.9925 - precision_3: 0.9949 - val_loss: 0.0842 - val_accuracy: 0.9761 - val_auc_3: 0.9976 - val_recall_3: 0.9545 - val_precision_3: 0.9976
Epoch 12/30
159/159 - 5s - loss: 0.0278 - accuracy: 0.9935 - auc_3: 0.9979 - recall_3: 0.9926 - precision_3: 0.9943 - val_loss: 0.0239 - val_accuracy: 0.9935 - val_auc_3: 0.9984 - val_recall_3: 0.9903 - val_precision_3: 0.9968
Epoch 13/30
159/159 - 5s - loss: 0.0262 - accuracy: 0.9939 - auc_3: 0.9981 - recall_3: 0.9925 - precision_3: 0.9953 - val_loss: 0.0211 - val_accuracy: 0.9943 - val_auc_3: 0.9990 - val_recall_3: 0.9920 - val_precision_3: 0.9966
Epoch 14/30
159/159 - 5s - loss: 0.0268 - accuracy: 0.9936 - auc_3: 0.9982 - recall_3: 0.9924 - precision_3: 0.9948 - val_loss: 0.0851 - val_accuracy: 0.9724 - val_auc_3: 0.9985 - val_recall_3: 0.9459 - val_precision_3: 0.9988
Epoch 15/30
159/159 - 5s - loss: 0.0268 - accuracy: 0.9935 - auc_3: 0.9984 - recall_3: 0.9926 - precision_3: 0.9944 - val_loss: 0.0237 - val_accuracy: 0.9937 - val_auc_3: 0.9988 - val_recall_3: 0.9926 - val_precision_3: 0.9947
Epoch 16/30
159/159 - 5s - loss: 0.0268 - accuracy: 0.9937 - auc_3: 0.9982 - recall_3: 0.9925 - precision_3: 0.9949 - val_loss: 0.0213 - val_accuracy: 0.9948 - val_auc_3: 0.9989 - val_recall_3: 0.9917 - val_precision_3: 0.9979
Epoch 17/30
159/159 - 5s - loss: 0.0262 - accuracy: 0.9937 - auc_3: 0.9983 - recall_3: 0.9925 - precision_3: 0.9950 - val_loss: 0.0311 - val_accuracy: 0.9912 - val_auc_3: 0.9981 - val_recall_3: 0.9846 - val_precision_3: 0.9978
Epoch 18/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9937 - auc_3: 0.9982 - recall_3: 0.9925 - precision_3: 0.9949 - val_loss: 0.0262 - val_accuracy: 0.9948 - val_auc_3: 0.9986 - val_recall_3: 0.9922 - val_precision_3: 0.9973
Epoch 19/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9935 - auc_3: 0.9983 - recall_3: 0.9922 - precision_3: 0.9948 - val_loss: 0.0393 - val_accuracy: 0.9908 - val_auc_3: 0.9982 - val_recall_3: 0.9899 - val_precision_3: 0.9917
Epoch 20/30
159/159 - 5s - loss: 0.0273 - accuracy: 0.9935 - auc_3: 0.9981 - recall_3: 0.9926 - precision_3: 0.9943 - val_loss: 0.0318 - val_accuracy: 0.9935 - val_auc_3: 0.9984 - val_recall_3: 0.9945 - val_precision_3: 0.9925
Epoch 21/30
159/159 - 5s - loss: 0.0276 - accuracy: 0.9936 - auc_3: 0.9980 - recall_3: 0.9923 - precision_3: 0.9949 - val_loss: 0.0225 - val_accuracy: 0.9944 - val_auc_3: 0.9988 - val_recall_3: 0.9918 - val_precision_3: 0.9971
Epoch 22/30
159/159 - 5s - loss: 0.0259 - accuracy: 0.9938 - auc_3: 0.9983 - recall_3: 0.9928 - precision_3: 0.9948 - val_loss: 0.0276 - val_accuracy: 0.9925 - val_auc_3: 0.9987 - val_recall_3: 0.9863 - val_precision_3: 0.9987
Epoch 23/30
159/159 - 5s - loss: 0.0253 - accuracy: 0.9938 - auc_3: 0.9985 - recall_3: 0.9925 - precision_3: 0.9950 - val_loss: 0.0234 - val_accuracy: 0.9944 - val_auc_3: 0.9986 - val_recall_3: 0.9917 - val_precision_3: 0.9972
Epoch 24/30
159/159 - 5s - loss: 0.0248 - accuracy: 0.9939 - auc_3: 0.9984 - recall_3: 0.9924 - precision_3: 0.9955 - val_loss: 0.0319 - val_accuracy: 0.9946 - val_auc_3: 0.9988 - val_recall_3: 0.9905 - val_precision_3: 0.9988
Epoch 25/30
159/159 - 5s - loss: 0.0245 - accuracy: 0.9939 - auc_3: 0.9985 - recall_3: 0.9922 - precision_3: 0.9956 - val_loss: 0.0300 - val_accuracy: 0.9933 - val_auc_3: 0.9988 - val_recall_3: 0.9899 - val_precision_3: 0.9966
Epoch 26/30
159/159 - 5s - loss: 0.0249 - accuracy: 0.9938 - auc_3: 0.9985 - recall_3: 0.9922 - precision_3: 0.9953 - val_loss: 0.0318 - val_accuracy: 0.9935 - val_auc_3: 0.9986 - val_recall_3: 0.9883 - val_precision_3: 0.9987
Epoch 27/30
159/159 - 5s - loss: 0.0251 - accuracy: 0.9940 - auc_3: 0.9985 - recall_3: 0.9925 - precision_3: 0.9954 - val_loss: 0.0332 - val_accuracy: 0.9949 - val_auc_3: 0.9988 - val_recall_3: 0.9908 - val_precision_3: 0.9990
Epoch 28/30
159/159 - 5s - loss: 0.0252 - accuracy: 0.9938 - auc_3: 0.9983 - recall_3: 0.9924 - precision_3: 0.9951 - val_loss: 0.0251 - val_accuracy: 0.9951 - val_auc_3: 0.9989 - val_recall_3: 0.9922 - val_precision_3: 0.9981
Epoch 29/30
159/159 - 4s - loss: 0.0248 - accuracy: 0.9940 - auc_3: 0.9985 - recall_3: 0.9923 - precision_3: 0.9957 - val_loss: 0.0278 - val_accuracy: 0.9945 - val_auc_3: 0.9984 - val_recall_3: 0.9932 - val_precision_3: 0.9958
Epoch 30/30
159/159 - 4s - loss: 0.0247 - accuracy: 0.9940 - auc_3: 0.9985 - recall_3: 0.9923 - precision_3: 0.9957 - val_loss: 0.0321 - val_accuracy: 0.9949 - val_auc_3: 0.9983 - val_recall_3: 0.9917 - val_precision_3: 0.9980
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 4s - loss: 0.3639 - accuracy: 0.8628 - auc_4: 0.9011 - recall_4: 0.8140 - precision_4: 0.9054 - val_loss: 0.2933 - val_accuracy: 0.8920 - val_auc_4: 0.9329 - val_recall_4: 0.8345 - val_precision_4: 0.9444
Epoch 2/20
558/558 - 1s - loss: 0.2796 - accuracy: 0.8899 - auc_4: 0.9307 - recall_4: 0.8180 - precision_4: 0.9585 - val_loss: 0.2585 - val_accuracy: 0.8961 - val_auc_4: 0.9391 - val_recall_4: 0.8285 - val_precision_4: 0.9593
Epoch 3/20
558/558 - 1s - loss: 0.2663 - accuracy: 0.8959 - auc_4: 0.9330 - recall_4: 0.8217 - precision_4: 0.9678 - val_loss: 0.2611 - val_accuracy: 0.8991 - val_auc_4: 0.9390 - val_recall_4: 0.8315 - val_precision_4: 0.9628
Epoch 4/20
558/558 - 1s - loss: 0.2603 - accuracy: 0.8970 - auc_4: 0.9361 - recall_4: 0.8218 - precision_4: 0.9701 - val_loss: 0.2479 - val_accuracy: 0.9026 - val_auc_4: 0.9415 - val_recall_4: 0.8365 - val_precision_4: 0.9653
Epoch 5/20
558/558 - 1s - loss: 0.2534 - accuracy: 0.8984 - auc_4: 0.9369 - recall_4: 0.8212 - precision_4: 0.9740 - val_loss: 0.2451 - val_accuracy: 0.9057 - val_auc_4: 0.9427 - val_recall_4: 0.8375 - val_precision_4: 0.9709
Epoch 6/20
558/558 - 1s - loss: 0.2511 - accuracy: 0.9004 - auc_4: 0.9371 - recall_4: 0.8226 - precision_4: 0.9768 - val_loss: 0.2593 - val_accuracy: 0.9021 - val_auc_4: 0.9364 - val_recall_4: 0.8275 - val_precision_4: 0.9740
Epoch 7/20
558/558 - 1s - loss: 0.2502 - accuracy: 0.9004 - auc_4: 0.9367 - recall_4: 0.8224 - precision_4: 0.9772 - val_loss: 0.2369 - val_accuracy: 0.9107 - val_auc_4: 0.9444 - val_recall_4: 0.8385 - val_precision_4: 0.9812
Epoch 8/20
558/558 - 1s - loss: 0.2459 - accuracy: 0.9022 - auc_4: 0.9381 - recall_4: 0.8230 - precision_4: 0.9806 - val_loss: 0.2468 - val_accuracy: 0.9082 - val_auc_4: 0.9400 - val_recall_4: 0.8295 - val_precision_4: 0.9857
Epoch 9/20
558/558 - 1s - loss: 0.2452 - accuracy: 0.9026 - auc_4: 0.9394 - recall_4: 0.8226 - precision_4: 0.9819 - val_loss: 0.2492 - val_accuracy: 0.8951 - val_auc_4: 0.9435 - val_recall_4: 0.8114 - val_precision_4: 0.9759
Epoch 10/20
558/558 - 1s - loss: 0.2438 - accuracy: 0.9023 - auc_4: 0.9391 - recall_4: 0.8230 - precision_4: 0.9810 - val_loss: 0.2432 - val_accuracy: 0.9057 - val_auc_4: 0.9442 - val_recall_4: 0.8345 - val_precision_4: 0.9742
Epoch 11/20
558/558 - 1s - loss: 0.2413 - accuracy: 0.9037 - auc_4: 0.9386 - recall_4: 0.8232 - precision_4: 0.9838 - val_loss: 0.2335 - val_accuracy: 0.9117 - val_auc_4: 0.9449 - val_recall_4: 0.8415 - val_precision_4: 0.9801
Epoch 12/20
558/558 - 1s - loss: 0.2413 - accuracy: 0.9037 - auc_4: 0.9403 - recall_4: 0.8235 - precision_4: 0.9836 - val_loss: 0.2431 - val_accuracy: 0.9117 - val_auc_4: 0.9433 - val_recall_4: 0.8385 - val_precision_4: 0.9835
Epoch 13/20
558/558 - 1s - loss: 0.2399 - accuracy: 0.9040 - auc_4: 0.9412 - recall_4: 0.8236 - precision_4: 0.9840 - val_loss: 0.2275 - val_accuracy: 0.9127 - val_auc_4: 0.9461 - val_recall_4: 0.8395 - val_precision_4: 0.9847
Epoch 14/20
558/558 - 1s - loss: 0.2392 - accuracy: 0.9040 - auc_4: 0.9399 - recall_4: 0.8235 - precision_4: 0.9842 - val_loss: 0.2321 - val_accuracy: 0.9092 - val_auc_4: 0.9449 - val_recall_4: 0.8375 - val_precision_4: 0.9789
Epoch 15/20
558/558 - 1s - loss: 0.2383 - accuracy: 0.9040 - auc_4: 0.9394 - recall_4: 0.8233 - precision_4: 0.9845 - val_loss: 0.2361 - val_accuracy: 0.9077 - val_auc_4: 0.9445 - val_recall_4: 0.8415 - val_precision_4: 0.9711
Epoch 16/20
558/558 - 1s - loss: 0.2371 - accuracy: 0.9053 - auc_4: 0.9392 - recall_4: 0.8243 - precision_4: 0.9863 - val_loss: 0.2247 - val_accuracy: 0.9132 - val_auc_4: 0.9464 - val_recall_4: 0.8385 - val_precision_4: 0.9870
Epoch 17/20
558/558 - 1s - loss: 0.2345 - accuracy: 0.9059 - auc_4: 0.9405 - recall_4: 0.8244 - precision_4: 0.9877 - val_loss: 0.2379 - val_accuracy: 0.9087 - val_auc_4: 0.9426 - val_recall_4: 0.8295 - val_precision_4: 0.9869
Epoch 18/20
558/558 - 1s - loss: 0.2361 - accuracy: 0.9052 - auc_4: 0.9414 - recall_4: 0.8235 - precision_4: 0.9870 - val_loss: 0.2271 - val_accuracy: 0.9112 - val_auc_4: 0.9456 - val_recall_4: 0.8415 - val_precision_4: 0.9790
Epoch 19/20
558/558 - 1s - loss: 0.2357 - accuracy: 0.9055 - auc_4: 0.9398 - recall_4: 0.8237 - precision_4: 0.9875 - val_loss: 0.2297 - val_accuracy: 0.9127 - val_auc_4: 0.9446 - val_recall_4: 0.8395 - val_precision_4: 0.9847
Epoch 20/20
558/558 - 1s - loss: 0.2326 - accuracy: 0.9069 - auc_4: 0.9411 - recall_4: 0.8251 - precision_4: 0.9892 - val_loss: 0.2254 - val_accuracy: 0.9137 - val_auc_4: 0.9462 - val_recall_4: 0.8415 - val_precision_4: 0.9847
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.635535394427175, 'accuracy': 0.9562957713205764, 'precision': 0.8036529680365296, 'recall': 0.5534591194968553, 'f1': 0.6554934823091247, 'fp': 43, 'tp': 176, 'fn': 142, 'tn': 3872, 'auprc': 0.5743173092792139, 'precision99': 0.99, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.04147744474719951
proportion of infection events tagged by ps-detector-recon detector:  0.4827934201231204
proportion of infection events tagged by ps-detector-infec detector:  0.4234534261782218
proportion of events estimated to be benign :  0.06620244222424058
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_10 (LSTM)                  [(None, 10, 128), (N 68096       input_3[0][0]                    
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 128)          512         lstm_10[0][1]                    
__________________________________________________________________________________________________
repeat_vector_1 (RepeatVector)  (None, 10, 128)      0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 128)          512         lstm_10[0][2]                    
__________________________________________________________________________________________________
lstm_11 (LSTM)                  (None, 10, 128)      131584      repeat_vector_1[0][0]            
                                                                 batch_normalization_3[0][0]      
                                                                 batch_normalization_4[0][0]      
__________________________________________________________________________________________________
dot_2 (Dot)                     (None, 10, 10)       0           lstm_11[0][0]                    
                                                                 lstm_10[0][0]                    
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 10, 10)       0           dot_2[0][0]                      
__________________________________________________________________________________________________
dot_3 (Dot)                     (None, 10, 128)      0           activation_2[0][0]               
                                                                 lstm_10[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 10, 128)      512         dot_3[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 10, 256)      0           batch_normalization_5[0][0]      
                                                                 lstm_11[0][0]                    
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 10, 1)        257         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 10, 1)        0           time_distributed_1[0][0]         
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 11s - loss: 0.0558 - accuracy: 0.9852 - auc_5: 0.9957 - recall_5: 0.9855 - precision_5: 0.9850 - val_loss: 0.0347 - val_accuracy: 0.9920 - val_auc_5: 0.9974 - val_recall_5: 0.9941 - val_precision_5: 0.9895
Epoch 2/30
159/159 - 5s - loss: 0.0321 - accuracy: 0.9932 - auc_5: 0.9970 - recall_5: 0.9933 - precision_5: 0.9932 - val_loss: 0.0312 - val_accuracy: 0.9929 - val_auc_5: 0.9978 - val_recall_5: 0.9932 - val_precision_5: 0.9922
Epoch 3/30
159/159 - 5s - loss: 0.0320 - accuracy: 0.9931 - auc_5: 0.9972 - recall_5: 0.9928 - precision_5: 0.9936 - val_loss: 0.0308 - val_accuracy: 0.9927 - val_auc_5: 0.9973 - val_recall_5: 0.9942 - val_precision_5: 0.9908
Epoch 4/30
159/159 - 5s - loss: 0.0314 - accuracy: 0.9934 - auc_5: 0.9971 - recall_5: 0.9927 - precision_5: 0.9942 - val_loss: 0.0285 - val_accuracy: 0.9934 - val_auc_5: 0.9972 - val_recall_5: 0.9924 - val_precision_5: 0.9941
Epoch 5/30
159/159 - 5s - loss: 0.0299 - accuracy: 0.9932 - auc_5: 0.9973 - recall_5: 0.9927 - precision_5: 0.9938 - val_loss: 0.0277 - val_accuracy: 0.9937 - val_auc_5: 0.9979 - val_recall_5: 0.9901 - val_precision_5: 0.9971
Epoch 6/30
159/159 - 5s - loss: 0.0291 - accuracy: 0.9936 - auc_5: 0.9974 - recall_5: 0.9924 - precision_5: 0.9949 - val_loss: 0.0286 - val_accuracy: 0.9929 - val_auc_5: 0.9983 - val_recall_5: 0.9938 - val_precision_5: 0.9916
Epoch 7/30
159/159 - 5s - loss: 0.0302 - accuracy: 0.9932 - auc_5: 0.9973 - recall_5: 0.9922 - precision_5: 0.9943 - val_loss: 0.0309 - val_accuracy: 0.9924 - val_auc_5: 0.9981 - val_recall_5: 0.9944 - val_precision_5: 0.9901
Epoch 8/30
159/159 - 5s - loss: 0.0293 - accuracy: 0.9938 - auc_5: 0.9971 - recall_5: 0.9928 - precision_5: 0.9948 - val_loss: 0.0312 - val_accuracy: 0.9938 - val_auc_5: 0.9979 - val_recall_5: 0.9910 - val_precision_5: 0.9963
Epoch 9/30
159/159 - 5s - loss: 0.0279 - accuracy: 0.9935 - auc_5: 0.9977 - recall_5: 0.9927 - precision_5: 0.9944 - val_loss: 0.0294 - val_accuracy: 0.9927 - val_auc_5: 0.9983 - val_recall_5: 0.9938 - val_precision_5: 0.9912
Epoch 10/30
159/159 - 5s - loss: 0.0291 - accuracy: 0.9932 - auc_5: 0.9976 - recall_5: 0.9922 - precision_5: 0.9942 - val_loss: 0.0284 - val_accuracy: 0.9925 - val_auc_5: 0.9977 - val_recall_5: 0.9889 - val_precision_5: 0.9957
Epoch 11/30
159/159 - 5s - loss: 0.0310 - accuracy: 0.9937 - auc_5: 0.9978 - recall_5: 0.9926 - precision_5: 0.9949 - val_loss: 0.0359 - val_accuracy: 0.9876 - val_auc_5: 0.9981 - val_recall_5: 0.9964 - val_precision_5: 0.9786
Epoch 12/30
159/159 - 5s - loss: 0.0305 - accuracy: 0.9932 - auc_5: 0.9977 - recall_5: 0.9925 - precision_5: 0.9940 - val_loss: 0.0268 - val_accuracy: 0.9937 - val_auc_5: 0.9989 - val_recall_5: 0.9911 - val_precision_5: 0.9959
Epoch 13/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9936 - auc_5: 0.9981 - recall_5: 0.9925 - precision_5: 0.9948 - val_loss: 0.0283 - val_accuracy: 0.9930 - val_auc_5: 0.9990 - val_recall_5: 0.9936 - val_precision_5: 0.9919
Epoch 14/30
159/159 - 5s - loss: 0.0260 - accuracy: 0.9937 - auc_5: 0.9983 - recall_5: 0.9925 - precision_5: 0.9950 - val_loss: 0.0257 - val_accuracy: 0.9931 - val_auc_5: 0.9988 - val_recall_5: 0.9931 - val_precision_5: 0.9928
Epoch 15/30
159/159 - 5s - loss: 0.0271 - accuracy: 0.9938 - auc_5: 0.9983 - recall_5: 0.9928 - precision_5: 0.9949 - val_loss: 0.0323 - val_accuracy: 0.9933 - val_auc_5: 0.9989 - val_recall_5: 0.9926 - val_precision_5: 0.9937
Epoch 16/30
159/159 - 5s - loss: 0.0259 - accuracy: 0.9938 - auc_5: 0.9982 - recall_5: 0.9929 - precision_5: 0.9948 - val_loss: 0.0310 - val_accuracy: 0.9938 - val_auc_5: 0.9988 - val_recall_5: 0.9908 - val_precision_5: 0.9964
Epoch 17/30
159/159 - 5s - loss: 0.0259 - accuracy: 0.9939 - auc_5: 0.9983 - recall_5: 0.9927 - precision_5: 0.9952 - val_loss: 0.0266 - val_accuracy: 0.9936 - val_auc_5: 0.9979 - val_recall_5: 0.9909 - val_precision_5: 0.9960
Epoch 18/30
159/159 - 5s - loss: 0.0246 - accuracy: 0.9940 - auc_5: 0.9984 - recall_5: 0.9929 - precision_5: 0.9952 - val_loss: 0.0244 - val_accuracy: 0.9936 - val_auc_5: 0.9987 - val_recall_5: 0.9914 - val_precision_5: 0.9955
Epoch 19/30
159/159 - 5s - loss: 0.0246 - accuracy: 0.9939 - auc_5: 0.9983 - recall_5: 0.9927 - precision_5: 0.9952 - val_loss: 0.0252 - val_accuracy: 0.9935 - val_auc_5: 0.9988 - val_recall_5: 0.9921 - val_precision_5: 0.9946
Epoch 20/30
159/159 - 5s - loss: 0.0237 - accuracy: 0.9941 - auc_5: 0.9986 - recall_5: 0.9927 - precision_5: 0.9956 - val_loss: 0.0244 - val_accuracy: 0.9939 - val_auc_5: 0.9988 - val_recall_5: 0.9908 - val_precision_5: 0.9967
Epoch 21/30
159/159 - 5s - loss: 0.0237 - accuracy: 0.9941 - auc_5: 0.9985 - recall_5: 0.9926 - precision_5: 0.9956 - val_loss: 0.0283 - val_accuracy: 0.9930 - val_auc_5: 0.9985 - val_recall_5: 0.9923 - val_precision_5: 0.9934
Epoch 22/30
159/159 - 5s - loss: 0.0250 - accuracy: 0.9937 - auc_5: 0.9984 - recall_5: 0.9926 - precision_5: 0.9949 - val_loss: 0.0251 - val_accuracy: 0.9939 - val_auc_5: 0.9987 - val_recall_5: 0.9913 - val_precision_5: 0.9961
Epoch 23/30
159/159 - 5s - loss: 0.0239 - accuracy: 0.9944 - auc_5: 0.9985 - recall_5: 0.9928 - precision_5: 0.9961 - val_loss: 0.0251 - val_accuracy: 0.9937 - val_auc_5: 0.9985 - val_recall_5: 0.9927 - val_precision_5: 0.9943
Epoch 24/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9937 - auc_5: 0.9982 - recall_5: 0.9925 - precision_5: 0.9950 - val_loss: 0.0244 - val_accuracy: 0.9939 - val_auc_5: 0.9988 - val_recall_5: 0.9909 - val_precision_5: 0.9966
Epoch 25/30
159/159 - 5s - loss: 0.0260 - accuracy: 0.9940 - auc_5: 0.9984 - recall_5: 0.9924 - precision_5: 0.9955 - val_loss: 0.0246 - val_accuracy: 0.9940 - val_auc_5: 0.9988 - val_recall_5: 0.9915 - val_precision_5: 0.9963
Epoch 26/30
159/159 - 5s - loss: 0.0240 - accuracy: 0.9941 - auc_5: 0.9984 - recall_5: 0.9927 - precision_5: 0.9955 - val_loss: 0.0252 - val_accuracy: 0.9940 - val_auc_5: 0.9985 - val_recall_5: 0.9908 - val_precision_5: 0.9968
Epoch 27/30
159/159 - 5s - loss: 0.0246 - accuracy: 0.9939 - auc_5: 0.9985 - recall_5: 0.9924 - precision_5: 0.9954 - val_loss: 0.0257 - val_accuracy: 0.9939 - val_auc_5: 0.9991 - val_recall_5: 0.9905 - val_precision_5: 0.9969
Epoch 28/30
159/159 - 5s - loss: 0.0248 - accuracy: 0.9941 - auc_5: 0.9984 - recall_5: 0.9928 - precision_5: 0.9954 - val_loss: 0.0294 - val_accuracy: 0.9938 - val_auc_5: 0.9980 - val_recall_5: 0.9906 - val_precision_5: 0.9968
Epoch 29/30
159/159 - 4s - loss: 0.0241 - accuracy: 0.9941 - auc_5: 0.9985 - recall_5: 0.9923 - precision_5: 0.9960 - val_loss: 0.0260 - val_accuracy: 0.9939 - val_auc_5: 0.9987 - val_recall_5: 0.9905 - val_precision_5: 0.9970
Epoch 30/30
159/159 - 4s - loss: 0.0246 - accuracy: 0.9940 - auc_5: 0.9985 - recall_5: 0.9927 - precision_5: 0.9955 - val_loss: 0.0254 - val_accuracy: 0.9936 - val_auc_5: 0.9987 - val_recall_5: 0.9896 - val_precision_5: 0.9972
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 4s - loss: 0.3649 - accuracy: 0.8520 - auc_6: 0.9000 - recall_6: 0.7912 - precision_6: 0.9058 - val_loss: 0.3049 - val_accuracy: 0.8819 - val_auc_6: 0.9225 - val_recall_6: 0.8014 - val_precision_6: 0.9569
Epoch 2/20
558/558 - 1s - loss: 0.2693 - accuracy: 0.8958 - auc_6: 0.9339 - recall_6: 0.8244 - precision_6: 0.9657 - val_loss: 0.2695 - val_accuracy: 0.8915 - val_auc_6: 0.9301 - val_recall_6: 0.7994 - val_precision_6: 0.9815
Epoch 3/20
558/558 - 1s - loss: 0.2576 - accuracy: 0.8988 - auc_6: 0.9379 - recall_6: 0.8238 - precision_6: 0.9730 - val_loss: 0.2633 - val_accuracy: 0.8956 - val_auc_6: 0.9330 - val_recall_6: 0.8074 - val_precision_6: 0.9817
Epoch 4/20
558/558 - 1s - loss: 0.2502 - accuracy: 0.9008 - auc_6: 0.9383 - recall_6: 0.8252 - precision_6: 0.9761 - val_loss: 0.2677 - val_accuracy: 0.8956 - val_auc_6: 0.9333 - val_recall_6: 0.8064 - val_precision_6: 0.9829
Epoch 5/20
558/558 - 1s - loss: 0.2461 - accuracy: 0.9015 - auc_6: 0.9397 - recall_6: 0.8244 - precision_6: 0.9787 - val_loss: 0.2484 - val_accuracy: 0.8996 - val_auc_6: 0.9357 - val_recall_6: 0.8144 - val_precision_6: 0.9831
Epoch 6/20
558/558 - 1s - loss: 0.2427 - accuracy: 0.9036 - auc_6: 0.9406 - recall_6: 0.8263 - precision_6: 0.9811 - val_loss: 0.2485 - val_accuracy: 0.8956 - val_auc_6: 0.9339 - val_recall_6: 0.8004 - val_precision_6: 0.9901
Epoch 7/20
558/558 - 1s - loss: 0.2396 - accuracy: 0.9045 - auc_6: 0.9401 - recall_6: 0.8264 - precision_6: 0.9831 - val_loss: 0.2553 - val_accuracy: 0.8951 - val_auc_6: 0.9353 - val_recall_6: 0.8084 - val_precision_6: 0.9793
Epoch 8/20
558/558 - 1s - loss: 0.2385 - accuracy: 0.9046 - auc_6: 0.9403 - recall_6: 0.8261 - precision_6: 0.9836 - val_loss: 0.2457 - val_accuracy: 0.9011 - val_auc_6: 0.9375 - val_recall_6: 0.8104 - val_precision_6: 0.9914
Epoch 9/20
558/558 - 1s - loss: 0.2378 - accuracy: 0.9055 - auc_6: 0.9408 - recall_6: 0.8270 - precision_6: 0.9846 - val_loss: 0.2414 - val_accuracy: 0.8981 - val_auc_6: 0.9371 - val_recall_6: 0.8064 - val_precision_6: 0.9889
Epoch 10/20
558/558 - 1s - loss: 0.2348 - accuracy: 0.9061 - auc_6: 0.9394 - recall_6: 0.8268 - precision_6: 0.9863 - val_loss: 0.2376 - val_accuracy: 0.9031 - val_auc_6: 0.9368 - val_recall_6: 0.8134 - val_precision_6: 0.9927
Epoch 11/20
558/558 - 1s - loss: 0.2351 - accuracy: 0.9059 - auc_6: 0.9420 - recall_6: 0.8264 - precision_6: 0.9863 - val_loss: 0.2386 - val_accuracy: 0.9021 - val_auc_6: 0.9372 - val_recall_6: 0.8144 - val_precision_6: 0.9890
Epoch 12/20
558/558 - 1s - loss: 0.2329 - accuracy: 0.9069 - auc_6: 0.9411 - recall_6: 0.8278 - precision_6: 0.9871 - val_loss: 0.2441 - val_accuracy: 0.9006 - val_auc_6: 0.9381 - val_recall_6: 0.8084 - val_precision_6: 0.9926
Epoch 13/20
558/558 - 1s - loss: 0.2337 - accuracy: 0.9066 - auc_6: 0.9411 - recall_6: 0.8267 - precision_6: 0.9878 - val_loss: 0.2402 - val_accuracy: 0.9016 - val_auc_6: 0.9366 - val_recall_6: 0.8154 - val_precision_6: 0.9867
Epoch 14/20
558/558 - 1s - loss: 0.2338 - accuracy: 0.9066 - auc_6: 0.9410 - recall_6: 0.8273 - precision_6: 0.9871 - val_loss: 0.2385 - val_accuracy: 0.9036 - val_auc_6: 0.9384 - val_recall_6: 0.8144 - val_precision_6: 0.9927
Epoch 15/20
558/558 - 1s - loss: 0.2308 - accuracy: 0.9075 - auc_6: 0.9415 - recall_6: 0.8281 - precision_6: 0.9882 - val_loss: 0.2442 - val_accuracy: 0.9006 - val_auc_6: 0.9366 - val_recall_6: 0.8124 - val_precision_6: 0.9878
Epoch 16/20
558/558 - 1s - loss: 0.2310 - accuracy: 0.9078 - auc_6: 0.9424 - recall_6: 0.8275 - precision_6: 0.9896 - val_loss: 0.2392 - val_accuracy: 0.9046 - val_auc_6: 0.9378 - val_recall_6: 0.8164 - val_precision_6: 0.9927
Epoch 17/20
558/558 - 1s - loss: 0.2304 - accuracy: 0.9075 - auc_6: 0.9427 - recall_6: 0.8274 - precision_6: 0.9891 - val_loss: 0.2367 - val_accuracy: 0.9031 - val_auc_6: 0.9388 - val_recall_6: 0.8134 - val_precision_6: 0.9927
Epoch 18/20
558/558 - 1s - loss: 0.2301 - accuracy: 0.9082 - auc_6: 0.9419 - recall_6: 0.8281 - precision_6: 0.9896 - val_loss: 0.2348 - val_accuracy: 0.9057 - val_auc_6: 0.9391 - val_recall_6: 0.8154 - val_precision_6: 0.9963
Epoch 19/20
558/558 - 1s - loss: 0.2278 - accuracy: 0.9083 - auc_6: 0.9439 - recall_6: 0.8280 - precision_6: 0.9900 - val_loss: 0.2335 - val_accuracy: 0.9057 - val_auc_6: 0.9385 - val_recall_6: 0.8164 - val_precision_6: 0.9951
Epoch 20/20
558/558 - 1s - loss: 0.2282 - accuracy: 0.9082 - auc_6: 0.9427 - recall_6: 0.8277 - precision_6: 0.9901 - val_loss: 0.2318 - val_accuracy: 0.9041 - val_auc_6: 0.9391 - val_recall_6: 0.8144 - val_precision_6: 0.9939
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.635535394427175, 'accuracy': 0.9562957713205764, 'precision': 0.8036529680365296, 'recall': 0.5534591194968553, 'f1': 0.6554934823091247, 'fp': 43, 'tp': 176, 'fn': 142, 'tn': 3872, 'auprc': 0.5743173092792139, 'precision99': 0.99, 'recall99': 0.0}
Round 1:
{'auc': 0.6183293573339117, 'accuracy': 0.9489723600283487, 'precision': 0.7161016949152542, 'recall': 0.5314465408805031, 'f1': 0.6101083032490976, 'fp': 67, 'tp': 169, 'fn': 149, 'tn': 3848, 'auprc': 0.5148409229864762, 'precision99': 0.99, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.04147744474719951
proportion of infection events tagged by ps-detector-recon detector:  0.4827934201231204
proportion of infection events tagged by ps-detector-infec detector:  0.4250176607124836
proportion of events estimated to be benign :  0.0660006055101423
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_14 (LSTM)                  [(None, 10, 128), (N 68096       input_5[0][0]                    
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 128)          512         lstm_14[0][1]                    
__________________________________________________________________________________________________
repeat_vector_2 (RepeatVector)  (None, 10, 128)      0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 128)          512         lstm_14[0][2]                    
__________________________________________________________________________________________________
lstm_15 (LSTM)                  (None, 10, 128)      131584      repeat_vector_2[0][0]            
                                                                 batch_normalization_6[0][0]      
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
dot_4 (Dot)                     (None, 10, 10)       0           lstm_15[0][0]                    
                                                                 lstm_14[0][0]                    
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 10, 10)       0           dot_4[0][0]                      
__________________________________________________________________________________________________
dot_5 (Dot)                     (None, 10, 128)      0           activation_4[0][0]               
                                                                 lstm_14[0][0]                    
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 10, 128)      512         dot_5[0][0]                      
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 10, 256)      0           batch_normalization_8[0][0]      
                                                                 lstm_15[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 10, 1)        257         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 10, 1)        0           time_distributed_2[0][0]         
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 11s - loss: 0.0545 - accuracy: 0.9892 - auc_7: 0.9954 - recall_7: 0.9910 - precision_7: 0.9874 - val_loss: 0.0514 - val_accuracy: 0.9926 - val_auc_7: 0.9977 - val_recall_7: 0.9958 - val_precision_7: 0.9896
Epoch 2/30
159/159 - 5s - loss: 0.0347 - accuracy: 0.9926 - auc_7: 0.9970 - recall_7: 0.9927 - precision_7: 0.9924 - val_loss: 0.0270 - val_accuracy: 0.9938 - val_auc_7: 0.9977 - val_recall_7: 0.9943 - val_precision_7: 0.9934
Epoch 3/30
159/159 - 5s - loss: 0.0319 - accuracy: 0.9930 - auc_7: 0.9972 - recall_7: 0.9925 - precision_7: 0.9934 - val_loss: 0.0415 - val_accuracy: 0.9911 - val_auc_7: 0.9967 - val_recall_7: 0.9860 - val_precision_7: 0.9965
Epoch 4/30
159/159 - 5s - loss: 0.0311 - accuracy: 0.9933 - auc_7: 0.9972 - recall_7: 0.9928 - precision_7: 0.9938 - val_loss: 0.0268 - val_accuracy: 0.9940 - val_auc_7: 0.9981 - val_recall_7: 0.9936 - val_precision_7: 0.9946
Epoch 5/30
159/159 - 5s - loss: 0.0312 - accuracy: 0.9930 - auc_7: 0.9973 - recall_7: 0.9923 - precision_7: 0.9937 - val_loss: 0.1138 - val_accuracy: 0.9768 - val_auc_7: 0.9964 - val_recall_7: 0.9573 - val_precision_7: 0.9967
Epoch 6/30
159/159 - 5s - loss: 0.0299 - accuracy: 0.9934 - auc_7: 0.9976 - recall_7: 0.9923 - precision_7: 0.9944 - val_loss: 0.0427 - val_accuracy: 0.9908 - val_auc_7: 0.9970 - val_recall_7: 0.9864 - val_precision_7: 0.9954
Epoch 7/30
159/159 - 5s - loss: 0.0273 - accuracy: 0.9935 - auc_7: 0.9980 - recall_7: 0.9920 - precision_7: 0.9950 - val_loss: 0.0276 - val_accuracy: 0.9940 - val_auc_7: 0.9977 - val_recall_7: 0.9943 - val_precision_7: 0.9939
Epoch 8/30
159/159 - 5s - loss: 0.0280 - accuracy: 0.9937 - auc_7: 0.9976 - recall_7: 0.9925 - precision_7: 0.9948 - val_loss: 0.0261 - val_accuracy: 0.9944 - val_auc_7: 0.9976 - val_recall_7: 0.9941 - val_precision_7: 0.9948
Epoch 9/30
159/159 - 5s - loss: 0.0295 - accuracy: 0.9934 - auc_7: 0.9976 - recall_7: 0.9925 - precision_7: 0.9942 - val_loss: 0.0370 - val_accuracy: 0.9914 - val_auc_7: 0.9984 - val_recall_7: 0.9855 - val_precision_7: 0.9975
Epoch 10/30
159/159 - 5s - loss: 0.0283 - accuracy: 0.9934 - auc_7: 0.9978 - recall_7: 0.9921 - precision_7: 0.9946 - val_loss: 0.0279 - val_accuracy: 0.9932 - val_auc_7: 0.9977 - val_recall_7: 0.9898 - val_precision_7: 0.9967
Epoch 11/30
159/159 - 5s - loss: 0.0276 - accuracy: 0.9932 - auc_7: 0.9980 - recall_7: 0.9919 - precision_7: 0.9945 - val_loss: 0.0382 - val_accuracy: 0.9924 - val_auc_7: 0.9975 - val_recall_7: 0.9880 - val_precision_7: 0.9968
Epoch 12/30
159/159 - 5s - loss: 0.0285 - accuracy: 0.9933 - auc_7: 0.9977 - recall_7: 0.9919 - precision_7: 0.9947 - val_loss: 0.0279 - val_accuracy: 0.9943 - val_auc_7: 0.9975 - val_recall_7: 0.9923 - val_precision_7: 0.9965
Epoch 13/30
159/159 - 5s - loss: 0.0266 - accuracy: 0.9937 - auc_7: 0.9982 - recall_7: 0.9921 - precision_7: 0.9952 - val_loss: 0.0482 - val_accuracy: 0.9860 - val_auc_7: 0.9970 - val_recall_7: 0.9756 - val_precision_7: 0.9967
Epoch 14/30
159/159 - 5s - loss: 0.0259 - accuracy: 0.9937 - auc_7: 0.9980 - recall_7: 0.9922 - precision_7: 0.9951 - val_loss: 0.0256 - val_accuracy: 0.9946 - val_auc_7: 0.9990 - val_recall_7: 0.9927 - val_precision_7: 0.9967
Epoch 15/30
159/159 - 5s - loss: 0.0259 - accuracy: 0.9937 - auc_7: 0.9982 - recall_7: 0.9921 - precision_7: 0.9952 - val_loss: 0.0257 - val_accuracy: 0.9945 - val_auc_7: 0.9988 - val_recall_7: 0.9924 - val_precision_7: 0.9968
Epoch 16/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9937 - auc_7: 0.9981 - recall_7: 0.9921 - precision_7: 0.9952 - val_loss: 0.0274 - val_accuracy: 0.9931 - val_auc_7: 0.9988 - val_recall_7: 0.9894 - val_precision_7: 0.9968
Epoch 17/30
159/159 - 5s - loss: 0.0293 - accuracy: 0.9928 - auc_7: 0.9980 - recall_7: 0.9914 - precision_7: 0.9941 - val_loss: 0.0354 - val_accuracy: 0.9920 - val_auc_7: 0.9987 - val_recall_7: 0.9881 - val_precision_7: 0.9961
Epoch 18/30
159/159 - 5s - loss: 0.0273 - accuracy: 0.9937 - auc_7: 0.9980 - recall_7: 0.9922 - precision_7: 0.9951 - val_loss: 0.0616 - val_accuracy: 0.9944 - val_auc_7: 0.9989 - val_recall_7: 0.9916 - val_precision_7: 0.9974
Epoch 19/30
159/159 - 5s - loss: 0.0261 - accuracy: 0.9937 - auc_7: 0.9982 - recall_7: 0.9921 - precision_7: 0.9954 - val_loss: 0.0242 - val_accuracy: 0.9940 - val_auc_7: 0.9990 - val_recall_7: 0.9935 - val_precision_7: 0.9947
Epoch 20/30
159/159 - 5s - loss: 0.0253 - accuracy: 0.9938 - auc_7: 0.9983 - recall_7: 0.9922 - precision_7: 0.9953 - val_loss: 0.0273 - val_accuracy: 0.9944 - val_auc_7: 0.9985 - val_recall_7: 0.9921 - val_precision_7: 0.9968
Epoch 21/30
159/159 - 5s - loss: 0.0252 - accuracy: 0.9939 - auc_7: 0.9983 - recall_7: 0.9922 - precision_7: 0.9955 - val_loss: 0.0230 - val_accuracy: 0.9945 - val_auc_7: 0.9981 - val_recall_7: 0.9934 - val_precision_7: 0.9958
Epoch 22/30
159/159 - 5s - loss: 0.0255 - accuracy: 0.9937 - auc_7: 0.9984 - recall_7: 0.9920 - precision_7: 0.9953 - val_loss: 0.0226 - val_accuracy: 0.9944 - val_auc_7: 0.9990 - val_recall_7: 0.9924 - val_precision_7: 0.9966
Epoch 23/30
159/159 - 5s - loss: 0.0280 - accuracy: 0.9935 - auc_7: 0.9983 - recall_7: 0.9920 - precision_7: 0.9949 - val_loss: 0.0244 - val_accuracy: 0.9945 - val_auc_7: 0.9990 - val_recall_7: 0.9930 - val_precision_7: 0.9961
Epoch 24/30
159/159 - 5s - loss: 0.0255 - accuracy: 0.9939 - auc_7: 0.9983 - recall_7: 0.9921 - precision_7: 0.9957 - val_loss: 0.0260 - val_accuracy: 0.9940 - val_auc_7: 0.9988 - val_recall_7: 0.9913 - val_precision_7: 0.9969
Epoch 25/30
159/159 - 5s - loss: 0.0256 - accuracy: 0.9935 - auc_7: 0.9985 - recall_7: 0.9922 - precision_7: 0.9948 - val_loss: 0.0235 - val_accuracy: 0.9941 - val_auc_7: 0.9989 - val_recall_7: 0.9936 - val_precision_7: 0.9947
Epoch 26/30
159/159 - 5s - loss: 0.0258 - accuracy: 0.9936 - auc_7: 0.9983 - recall_7: 0.9917 - precision_7: 0.9954 - val_loss: 0.0255 - val_accuracy: 0.9945 - val_auc_7: 0.9985 - val_recall_7: 0.9925 - val_precision_7: 0.9965
Epoch 27/30
159/159 - 5s - loss: 0.0244 - accuracy: 0.9940 - auc_7: 0.9983 - recall_7: 0.9919 - precision_7: 0.9961 - val_loss: 0.0230 - val_accuracy: 0.9946 - val_auc_7: 0.9989 - val_recall_7: 0.9929 - val_precision_7: 0.9965
Epoch 28/30
159/159 - 5s - loss: 0.0248 - accuracy: 0.9938 - auc_7: 0.9984 - recall_7: 0.9922 - precision_7: 0.9954 - val_loss: 0.0388 - val_accuracy: 0.9947 - val_auc_7: 0.9985 - val_recall_7: 0.9929 - val_precision_7: 0.9966
Epoch 29/30
159/159 - 4s - loss: 0.0242 - accuracy: 0.9940 - auc_7: 0.9984 - recall_7: 0.9917 - precision_7: 0.9962 - val_loss: 0.0234 - val_accuracy: 0.9946 - val_auc_7: 0.9988 - val_recall_7: 0.9935 - val_precision_7: 0.9959
Epoch 30/30
159/159 - 4s - loss: 0.0252 - accuracy: 0.9936 - auc_7: 0.9983 - recall_7: 0.9919 - precision_7: 0.9952 - val_loss: 0.0303 - val_accuracy: 0.9944 - val_auc_7: 0.9986 - val_recall_7: 0.9923 - val_precision_7: 0.9966
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 4s - loss: 0.3629 - accuracy: 0.8566 - auc_8: 0.9019 - recall_8: 0.8018 - precision_8: 0.9057 - val_loss: 0.2694 - val_accuracy: 0.8961 - val_auc_8: 0.9332 - val_recall_8: 0.8281 - val_precision_8: 0.9565
Epoch 2/20
558/558 - 1s - loss: 0.2669 - accuracy: 0.8950 - auc_8: 0.9349 - recall_8: 0.8221 - precision_8: 0.9667 - val_loss: 0.2449 - val_accuracy: 0.9046 - val_auc_8: 0.9389 - val_recall_8: 0.8240 - val_precision_8: 0.9806
Epoch 3/20
558/558 - 1s - loss: 0.2553 - accuracy: 0.8982 - auc_8: 0.9371 - recall_8: 0.8218 - precision_8: 0.9744 - val_loss: 0.2466 - val_accuracy: 0.9041 - val_auc_8: 0.9397 - val_recall_8: 0.8301 - val_precision_8: 0.9726
Epoch 4/20
558/558 - 1s - loss: 0.2511 - accuracy: 0.9003 - auc_8: 0.9372 - recall_8: 0.8231 - precision_8: 0.9775 - val_loss: 0.2397 - val_accuracy: 0.9057 - val_auc_8: 0.9400 - val_recall_8: 0.8281 - val_precision_8: 0.9784
Epoch 5/20
558/558 - 1s - loss: 0.2459 - accuracy: 0.9018 - auc_8: 0.9401 - recall_8: 0.8242 - precision_8: 0.9798 - val_loss: 0.2363 - val_accuracy: 0.9062 - val_auc_8: 0.9403 - val_recall_8: 0.8260 - val_precision_8: 0.9819
Epoch 6/20
558/558 - 1s - loss: 0.2435 - accuracy: 0.9026 - auc_8: 0.9393 - recall_8: 0.8243 - precision_8: 0.9814 - val_loss: 0.2339 - val_accuracy: 0.9092 - val_auc_8: 0.9415 - val_recall_8: 0.8220 - val_precision_8: 0.9938
Epoch 7/20
558/558 - 1s - loss: 0.2425 - accuracy: 0.9031 - auc_8: 0.9390 - recall_8: 0.8248 - precision_8: 0.9820 - val_loss: 0.2330 - val_accuracy: 0.9087 - val_auc_8: 0.9411 - val_recall_8: 0.8281 - val_precision_8: 0.9855
Epoch 8/20
558/558 - 1s - loss: 0.2388 - accuracy: 0.9039 - auc_8: 0.9401 - recall_8: 0.8249 - precision_8: 0.9837 - val_loss: 0.2303 - val_accuracy: 0.9102 - val_auc_8: 0.9408 - val_recall_8: 0.8291 - val_precision_8: 0.9879
Epoch 9/20
558/558 - 1s - loss: 0.2392 - accuracy: 0.9042 - auc_8: 0.9391 - recall_8: 0.8255 - precision_8: 0.9839 - val_loss: 0.2286 - val_accuracy: 0.9102 - val_auc_8: 0.9409 - val_recall_8: 0.8250 - val_precision_8: 0.9927
Epoch 10/20
558/558 - 1s - loss: 0.2368 - accuracy: 0.9050 - auc_8: 0.9409 - recall_8: 0.8243 - precision_8: 0.9869 - val_loss: 0.2306 - val_accuracy: 0.9117 - val_auc_8: 0.9414 - val_recall_8: 0.8301 - val_precision_8: 0.9903
Epoch 11/20
558/558 - 1s - loss: 0.2352 - accuracy: 0.9052 - auc_8: 0.9417 - recall_8: 0.8251 - precision_8: 0.9867 - val_loss: 0.2317 - val_accuracy: 0.9092 - val_auc_8: 0.9428 - val_recall_8: 0.8199 - val_precision_8: 0.9963
Epoch 12/20
558/558 - 1s - loss: 0.2355 - accuracy: 0.9050 - auc_8: 0.9394 - recall_8: 0.8249 - precision_8: 0.9863 - val_loss: 0.2290 - val_accuracy: 0.9117 - val_auc_8: 0.9419 - val_recall_8: 0.8271 - val_precision_8: 0.9939
Epoch 13/20
558/558 - 1s - loss: 0.2344 - accuracy: 0.9054 - auc_8: 0.9395 - recall_8: 0.8248 - precision_8: 0.9872 - val_loss: 0.2275 - val_accuracy: 0.9112 - val_auc_8: 0.9420 - val_recall_8: 0.8291 - val_precision_8: 0.9903
Epoch 14/20
558/558 - 1s - loss: 0.2334 - accuracy: 0.9055 - auc_8: 0.9399 - recall_8: 0.8252 - precision_8: 0.9872 - val_loss: 0.2263 - val_accuracy: 0.9122 - val_auc_8: 0.9417 - val_recall_8: 0.8301 - val_precision_8: 0.9915
Epoch 15/20
558/558 - 1s - loss: 0.2322 - accuracy: 0.9068 - auc_8: 0.9413 - recall_8: 0.8263 - precision_8: 0.9888 - val_loss: 0.2269 - val_accuracy: 0.9112 - val_auc_8: 0.9427 - val_recall_8: 0.8250 - val_precision_8: 0.9951
Epoch 16/20
558/558 - 1s - loss: 0.2327 - accuracy: 0.9063 - auc_8: 0.9393 - recall_8: 0.8253 - precision_8: 0.9889 - val_loss: 0.2236 - val_accuracy: 0.9122 - val_auc_8: 0.9421 - val_recall_8: 0.8301 - val_precision_8: 0.9915
Epoch 17/20
558/558 - 1s - loss: 0.2329 - accuracy: 0.9060 - auc_8: 0.9427 - recall_8: 0.8266 - precision_8: 0.9866 - val_loss: 0.2272 - val_accuracy: 0.9102 - val_auc_8: 0.9422 - val_recall_8: 0.8230 - val_precision_8: 0.9951
Epoch 18/20
558/558 - 1s - loss: 0.2313 - accuracy: 0.9066 - auc_8: 0.9401 - recall_8: 0.8255 - precision_8: 0.9893 - val_loss: 0.2261 - val_accuracy: 0.9122 - val_auc_8: 0.9423 - val_recall_8: 0.8301 - val_precision_8: 0.9915
Epoch 19/20
558/558 - 1s - loss: 0.2314 - accuracy: 0.9065 - auc_8: 0.9416 - recall_8: 0.8263 - precision_8: 0.9883 - val_loss: 0.2264 - val_accuracy: 0.9112 - val_auc_8: 0.9432 - val_recall_8: 0.8260 - val_precision_8: 0.9939
Epoch 20/20
558/558 - 1s - loss: 0.2301 - accuracy: 0.9070 - auc_8: 0.9410 - recall_8: 0.8258 - precision_8: 0.9898 - val_loss: 0.2248 - val_accuracy: 0.9112 - val_auc_8: 0.9423 - val_recall_8: 0.8291 - val_precision_8: 0.9903
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.635535394427175, 'accuracy': 0.9562957713205764, 'precision': 0.8036529680365296, 'recall': 0.5534591194968553, 'f1': 0.6554934823091247, 'fp': 43, 'tp': 176, 'fn': 142, 'tn': 3872, 'auprc': 0.5743173092792139, 'precision99': 0.99, 'recall99': 0.0}
Round 1:
{'auc': 0.6183293573339117, 'accuracy': 0.9489723600283487, 'precision': 0.7161016949152542, 'recall': 0.5314465408805031, 'f1': 0.6101083032490976, 'fp': 67, 'tp': 169, 'fn': 149, 'tn': 3848, 'auprc': 0.5148409229864762, 'precision99': 0.99, 'recall99': 0.0}
Round 2:
{'auc': 0.6225495393463296, 'accuracy': 0.9520434679896055, 'precision': 0.757847533632287, 'recall': 0.5314465408805031, 'f1': 0.6247689463955638, 'fp': 54, 'tp': 169, 'fn': 149, 'tn': 3861, 'auprc': 0.5590172821507615, 'precision99': 0.99, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.04147744474719951
proportion of infection events tagged by ps-detector-recon detector:  0.4827934201231204
proportion of infection events tagged by ps-detector-infec detector:  0.4250176607124836
proportion of events estimated to be benign :  0.06630336058128973
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model_3"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_18 (LSTM)                  [(None, 10, 128), (N 68096       input_7[0][0]                    
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 128)          512         lstm_18[0][1]                    
__________________________________________________________________________________________________
repeat_vector_3 (RepeatVector)  (None, 10, 128)      0           batch_normalization_9[0][0]      
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 128)          512         lstm_18[0][2]                    
__________________________________________________________________________________________________
lstm_19 (LSTM)                  (None, 10, 128)      131584      repeat_vector_3[0][0]            
                                                                 batch_normalization_9[0][0]      
                                                                 batch_normalization_10[0][0]     
__________________________________________________________________________________________________
dot_6 (Dot)                     (None, 10, 10)       0           lstm_19[0][0]                    
                                                                 lstm_18[0][0]                    
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 10, 10)       0           dot_6[0][0]                      
__________________________________________________________________________________________________
dot_7 (Dot)                     (None, 10, 128)      0           activation_6[0][0]               
                                                                 lstm_18[0][0]                    
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 10, 128)      512         dot_7[0][0]                      
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 10, 256)      0           batch_normalization_11[0][0]     
                                                                 lstm_19[0][0]                    
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 10, 1)        257         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 10, 1)        0           time_distributed_3[0][0]         
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 11s - loss: 0.0601 - accuracy: 0.9831 - auc_9: 0.9952 - recall_9: 0.9853 - precision_9: 0.9808 - val_loss: 0.0316 - val_accuracy: 0.9934 - val_auc_9: 0.9971 - val_recall_9: 0.9948 - val_precision_9: 0.9922
Epoch 2/30
159/159 - 5s - loss: 0.0346 - accuracy: 0.9925 - auc_9: 0.9969 - recall_9: 0.9924 - precision_9: 0.9926 - val_loss: 0.0383 - val_accuracy: 0.9932 - val_auc_9: 0.9960 - val_recall_9: 0.9917 - val_precision_9: 0.9950
Epoch 3/30
159/159 - 5s - loss: 0.0342 - accuracy: 0.9925 - auc_9: 0.9971 - recall_9: 0.9925 - precision_9: 0.9925 - val_loss: 0.0450 - val_accuracy: 0.9906 - val_auc_9: 0.9963 - val_recall_9: 0.9857 - val_precision_9: 0.9958
Epoch 4/30
159/159 - 5s - loss: 0.0302 - accuracy: 0.9934 - auc_9: 0.9974 - recall_9: 0.9927 - precision_9: 0.9940 - val_loss: 0.0373 - val_accuracy: 0.9926 - val_auc_9: 0.9978 - val_recall_9: 0.9883 - val_precision_9: 0.9970
Epoch 5/30
159/159 - 5s - loss: 0.0304 - accuracy: 0.9930 - auc_9: 0.9975 - recall_9: 0.9925 - precision_9: 0.9934 - val_loss: 0.0401 - val_accuracy: 0.9925 - val_auc_9: 0.9969 - val_recall_9: 0.9883 - val_precision_9: 0.9968
Epoch 6/30
159/159 - 5s - loss: 0.0286 - accuracy: 0.9931 - auc_9: 0.9977 - recall_9: 0.9920 - precision_9: 0.9942 - val_loss: 0.0286 - val_accuracy: 0.9942 - val_auc_9: 0.9986 - val_recall_9: 0.9941 - val_precision_9: 0.9945
Epoch 7/30
159/159 - 5s - loss: 0.0282 - accuracy: 0.9936 - auc_9: 0.9977 - recall_9: 0.9923 - precision_9: 0.9947 - val_loss: 0.0235 - val_accuracy: 0.9944 - val_auc_9: 0.9988 - val_recall_9: 0.9942 - val_precision_9: 0.9948
Epoch 8/30
159/159 - 5s - loss: 0.0279 - accuracy: 0.9933 - auc_9: 0.9981 - recall_9: 0.9923 - precision_9: 0.9943 - val_loss: 0.0259 - val_accuracy: 0.9943 - val_auc_9: 0.9984 - val_recall_9: 0.9933 - val_precision_9: 0.9956
Epoch 9/30
159/159 - 5s - loss: 0.0276 - accuracy: 0.9934 - auc_9: 0.9979 - recall_9: 0.9924 - precision_9: 0.9943 - val_loss: 0.0229 - val_accuracy: 0.9946 - val_auc_9: 0.9986 - val_recall_9: 0.9939 - val_precision_9: 0.9954
Epoch 10/30
159/159 - 5s - loss: 0.0273 - accuracy: 0.9934 - auc_9: 0.9980 - recall_9: 0.9924 - precision_9: 0.9944 - val_loss: 0.0252 - val_accuracy: 0.9934 - val_auc_9: 0.9985 - val_recall_9: 0.9943 - val_precision_9: 0.9927
Epoch 11/30
159/159 - 5s - loss: 0.0286 - accuracy: 0.9932 - auc_9: 0.9979 - recall_9: 0.9926 - precision_9: 0.9938 - val_loss: 0.0250 - val_accuracy: 0.9944 - val_auc_9: 0.9989 - val_recall_9: 0.9939 - val_precision_9: 0.9951
Epoch 12/30
159/159 - 5s - loss: 0.0265 - accuracy: 0.9934 - auc_9: 0.9981 - recall_9: 0.9921 - precision_9: 0.9948 - val_loss: 0.0263 - val_accuracy: 0.9942 - val_auc_9: 0.9987 - val_recall_9: 0.9942 - val_precision_9: 0.9944
Epoch 13/30
159/159 - 5s - loss: 0.0256 - accuracy: 0.9937 - auc_9: 0.9982 - recall_9: 0.9922 - precision_9: 0.9952 - val_loss: 0.0255 - val_accuracy: 0.9942 - val_auc_9: 0.9985 - val_recall_9: 0.9947 - val_precision_9: 0.9939
Epoch 14/30
159/159 - 5s - loss: 0.0255 - accuracy: 0.9937 - auc_9: 0.9984 - recall_9: 0.9924 - precision_9: 0.9950 - val_loss: 0.0245 - val_accuracy: 0.9945 - val_auc_9: 0.9986 - val_recall_9: 0.9936 - val_precision_9: 0.9955
Epoch 15/30
159/159 - 5s - loss: 0.0261 - accuracy: 0.9936 - auc_9: 0.9983 - recall_9: 0.9923 - precision_9: 0.9949 - val_loss: 0.0227 - val_accuracy: 0.9945 - val_auc_9: 0.9988 - val_recall_9: 0.9938 - val_precision_9: 0.9954
Epoch 16/30
159/159 - 5s - loss: 0.0267 - accuracy: 0.9934 - auc_9: 0.9983 - recall_9: 0.9925 - precision_9: 0.9942 - val_loss: 0.0248 - val_accuracy: 0.9948 - val_auc_9: 0.9989 - val_recall_9: 0.9933 - val_precision_9: 0.9965
Epoch 17/30
159/159 - 5s - loss: 0.0250 - accuracy: 0.9937 - auc_9: 0.9985 - recall_9: 0.9923 - precision_9: 0.9950 - val_loss: 0.0306 - val_accuracy: 0.9942 - val_auc_9: 0.9988 - val_recall_9: 0.9938 - val_precision_9: 0.9949
Epoch 18/30
159/159 - 5s - loss: 0.0254 - accuracy: 0.9937 - auc_9: 0.9983 - recall_9: 0.9926 - precision_9: 0.9947 - val_loss: 0.0236 - val_accuracy: 0.9940 - val_auc_9: 0.9988 - val_recall_9: 0.9943 - val_precision_9: 0.9939
Epoch 19/30
159/159 - 5s - loss: 0.0367 - accuracy: 0.9922 - auc_9: 0.9970 - recall_9: 0.9915 - precision_9: 0.9928 - val_loss: 0.0298 - val_accuracy: 0.9942 - val_auc_9: 0.9972 - val_recall_9: 0.9941 - val_precision_9: 0.9945
Epoch 20/30
159/159 - 5s - loss: 0.0304 - accuracy: 0.9930 - auc_9: 0.9975 - recall_9: 0.9933 - precision_9: 0.9926 - val_loss: 0.0277 - val_accuracy: 0.9942 - val_auc_9: 0.9984 - val_recall_9: 0.9938 - val_precision_9: 0.9948
Epoch 21/30
159/159 - 5s - loss: 0.0271 - accuracy: 0.9934 - auc_9: 0.9981 - recall_9: 0.9925 - precision_9: 0.9942 - val_loss: 0.0245 - val_accuracy: 0.9937 - val_auc_9: 0.9987 - val_recall_9: 0.9948 - val_precision_9: 0.9929
Epoch 22/30
159/159 - 5s - loss: 0.0278 - accuracy: 0.9933 - auc_9: 0.9981 - recall_9: 0.9924 - precision_9: 0.9941 - val_loss: 0.0268 - val_accuracy: 0.9941 - val_auc_9: 0.9974 - val_recall_9: 0.9939 - val_precision_9: 0.9945
Epoch 23/30
159/159 - 5s - loss: 0.0261 - accuracy: 0.9935 - auc_9: 0.9982 - recall_9: 0.9925 - precision_9: 0.9945 - val_loss: 0.0248 - val_accuracy: 0.9940 - val_auc_9: 0.9985 - val_recall_9: 0.9942 - val_precision_9: 0.9940
Epoch 24/30
159/159 - 5s - loss: 0.0268 - accuracy: 0.9932 - auc_9: 0.9981 - recall_9: 0.9921 - precision_9: 0.9942 - val_loss: 0.0246 - val_accuracy: 0.9942 - val_auc_9: 0.9984 - val_recall_9: 0.9943 - val_precision_9: 0.9943
Epoch 25/30
159/159 - 5s - loss: 0.0251 - accuracy: 0.9938 - auc_9: 0.9982 - recall_9: 0.9923 - precision_9: 0.9951 - val_loss: 0.0262 - val_accuracy: 0.9945 - val_auc_9: 0.9988 - val_recall_9: 0.9925 - val_precision_9: 0.9967
Epoch 26/30
159/159 - 5s - loss: 0.0262 - accuracy: 0.9934 - auc_9: 0.9984 - recall_9: 0.9924 - precision_9: 0.9944 - val_loss: 0.0249 - val_accuracy: 0.9943 - val_auc_9: 0.9988 - val_recall_9: 0.9933 - val_precision_9: 0.9955
Epoch 27/30
159/159 - 5s - loss: 0.0269 - accuracy: 0.9934 - auc_9: 0.9982 - recall_9: 0.9920 - precision_9: 0.9947 - val_loss: 0.0243 - val_accuracy: 0.9939 - val_auc_9: 0.9983 - val_recall_9: 0.9950 - val_precision_9: 0.9931
Epoch 28/30
159/159 - 5s - loss: 0.0257 - accuracy: 0.9937 - auc_9: 0.9983 - recall_9: 0.9922 - precision_9: 0.9950 - val_loss: 0.0298 - val_accuracy: 0.9928 - val_auc_9: 0.9986 - val_recall_9: 0.9956 - val_precision_9: 0.9903
Epoch 29/30
159/159 - 4s - loss: 0.5017 - accuracy: 0.9136 - auc_9: 0.9615 - recall_9: 0.9146 - precision_9: 0.9121 - val_loss: 0.9114 - val_accuracy: 0.4971 - val_auc_9: 0.7334 - val_recall_9: 0.3003 - val_precision_9: 0.5084
Epoch 30/30
159/159 - 5s - loss: 0.2080 - accuracy: 0.9459 - auc_9: 0.9793 - recall_9: 0.9499 - precision_9: 0.9420 - val_loss: 0.0338 - val_accuracy: 0.9930 - val_auc_9: 0.9963 - val_recall_9: 0.9952 - val_precision_9: 0.9910
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 5s - loss: 0.3580 - accuracy: 0.8606 - auc_10: 0.9047 - recall_10: 0.8059 - precision_10: 0.9092 - val_loss: 0.2667 - val_accuracy: 0.8971 - val_auc_10: 0.9404 - val_recall_10: 0.8381 - val_precision_10: 0.9550
Epoch 2/20
558/558 - 1s - loss: 0.2707 - accuracy: 0.8940 - auc_10: 0.9339 - recall_10: 0.8217 - precision_10: 0.9642 - val_loss: 0.2444 - val_accuracy: 0.9031 - val_auc_10: 0.9444 - val_recall_10: 0.8233 - val_precision_10: 0.9847
Epoch 3/20
558/558 - 1s - loss: 0.2588 - accuracy: 0.8974 - auc_10: 0.9344 - recall_10: 0.8210 - precision_10: 0.9727 - val_loss: 0.2340 - val_accuracy: 0.9072 - val_auc_10: 0.9458 - val_recall_10: 0.8401 - val_precision_10: 0.9748
Epoch 4/20
558/558 - 1s - loss: 0.2527 - accuracy: 0.8994 - auc_10: 0.9384 - recall_10: 0.8228 - precision_10: 0.9750 - val_loss: 0.2319 - val_accuracy: 0.9087 - val_auc_10: 0.9466 - val_recall_10: 0.8430 - val_precision_10: 0.9749
Epoch 5/20
558/558 - 1s - loss: 0.2490 - accuracy: 0.9010 - auc_10: 0.9383 - recall_10: 0.8233 - precision_10: 0.9783 - val_loss: 0.2311 - val_accuracy: 0.9082 - val_auc_10: 0.9467 - val_recall_10: 0.8421 - val_precision_10: 0.9749
Epoch 6/20
558/558 - 1s - loss: 0.2474 - accuracy: 0.9012 - auc_10: 0.9377 - recall_10: 0.8232 - precision_10: 0.9787 - val_loss: 0.2284 - val_accuracy: 0.9097 - val_auc_10: 0.9468 - val_recall_10: 0.8421 - val_precision_10: 0.9782
Epoch 7/20
558/558 - 1s - loss: 0.2445 - accuracy: 0.9022 - auc_10: 0.9385 - recall_10: 0.8226 - precision_10: 0.9817 - val_loss: 0.2333 - val_accuracy: 0.9097 - val_auc_10: 0.9461 - val_recall_10: 0.8421 - val_precision_10: 0.9782
Epoch 8/20
558/558 - 1s - loss: 0.2431 - accuracy: 0.9027 - auc_10: 0.9394 - recall_10: 0.8235 - precision_10: 0.9818 - val_loss: 0.2431 - val_accuracy: 0.9051 - val_auc_10: 0.9418 - val_recall_10: 0.8302 - val_precision_10: 0.9813
Epoch 9/20
558/558 - 1s - loss: 0.2423 - accuracy: 0.9029 - auc_10: 0.9381 - recall_10: 0.8239 - precision_10: 0.9820 - val_loss: 0.2225 - val_accuracy: 0.9142 - val_auc_10: 0.9479 - val_recall_10: 0.8411 - val_precision_10: 0.9895
Epoch 10/20
558/558 - 1s - loss: 0.2420 - accuracy: 0.9035 - auc_10: 0.9397 - recall_10: 0.8230 - precision_10: 0.9843 - val_loss: 0.2202 - val_accuracy: 0.9117 - val_auc_10: 0.9481 - val_recall_10: 0.8421 - val_precision_10: 0.9827
Epoch 11/20
558/558 - 1s - loss: 0.2385 - accuracy: 0.9051 - auc_10: 0.9392 - recall_10: 0.8244 - precision_10: 0.9864 - val_loss: 0.2237 - val_accuracy: 0.9112 - val_auc_10: 0.9474 - val_recall_10: 0.8421 - val_precision_10: 0.9816
Epoch 12/20
558/558 - 1s - loss: 0.2390 - accuracy: 0.9042 - auc_10: 0.9404 - recall_10: 0.8239 - precision_10: 0.9848 - val_loss: 0.2211 - val_accuracy: 0.9137 - val_auc_10: 0.9472 - val_recall_10: 0.8411 - val_precision_10: 0.9884
Epoch 13/20
558/558 - 1s - loss: 0.2368 - accuracy: 0.9051 - auc_10: 0.9400 - recall_10: 0.8245 - precision_10: 0.9863 - val_loss: 0.2195 - val_accuracy: 0.9122 - val_auc_10: 0.9478 - val_recall_10: 0.8401 - val_precision_10: 0.9861
Epoch 14/20
558/558 - 1s - loss: 0.2394 - accuracy: 0.9047 - auc_10: 0.9381 - recall_10: 0.8236 - precision_10: 0.9865 - val_loss: 0.2199 - val_accuracy: 0.9142 - val_auc_10: 0.9478 - val_recall_10: 0.8421 - val_precision_10: 0.9884
Epoch 15/20
558/558 - 1s - loss: 0.2347 - accuracy: 0.9063 - auc_10: 0.9404 - recall_10: 0.8259 - precision_10: 0.9873 - val_loss: 0.2171 - val_accuracy: 0.9142 - val_auc_10: 0.9490 - val_recall_10: 0.8391 - val_precision_10: 0.9918
Epoch 16/20
558/558 - 1s - loss: 0.2337 - accuracy: 0.9061 - auc_10: 0.9419 - recall_10: 0.8252 - precision_10: 0.9880 - val_loss: 0.2193 - val_accuracy: 0.9117 - val_auc_10: 0.9475 - val_recall_10: 0.8421 - val_precision_10: 0.9827
Epoch 17/20
558/558 - 1s - loss: 0.2349 - accuracy: 0.9059 - auc_10: 0.9411 - recall_10: 0.8250 - precision_10: 0.9876 - val_loss: 0.2126 - val_accuracy: 0.9137 - val_auc_10: 0.9487 - val_recall_10: 0.8411 - val_precision_10: 0.9884
Epoch 18/20
558/558 - 1s - loss: 0.2328 - accuracy: 0.9068 - auc_10: 0.9412 - recall_10: 0.8249 - precision_10: 0.9897 - val_loss: 0.2397 - val_accuracy: 0.9087 - val_auc_10: 0.9402 - val_recall_10: 0.8302 - val_precision_10: 0.9894
Epoch 19/20
558/558 - 1s - loss: 0.2350 - accuracy: 0.9051 - auc_10: 0.9407 - recall_10: 0.8234 - precision_10: 0.9877 - val_loss: 0.2162 - val_accuracy: 0.9147 - val_auc_10: 0.9487 - val_recall_10: 0.8421 - val_precision_10: 0.9896
Epoch 20/20
558/558 - 1s - loss: 0.2335 - accuracy: 0.9059 - auc_10: 0.9409 - recall_10: 0.8250 - precision_10: 0.9876 - val_loss: 0.2239 - val_accuracy: 0.9097 - val_auc_10: 0.9434 - val_recall_10: 0.8272 - val_precision_10: 0.9952
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.635535394427175, 'accuracy': 0.9562957713205764, 'precision': 0.8036529680365296, 'recall': 0.5534591194968553, 'f1': 0.6554934823091247, 'fp': 43, 'tp': 176, 'fn': 142, 'tn': 3872, 'auprc': 0.5743173092792139, 'precision99': 0.99, 'recall99': 0.0}
Round 1:
{'auc': 0.6183293573339117, 'accuracy': 0.9489723600283487, 'precision': 0.7161016949152542, 'recall': 0.5314465408805031, 'f1': 0.6101083032490976, 'fp': 67, 'tp': 169, 'fn': 149, 'tn': 3848, 'auprc': 0.5148409229864762, 'precision99': 0.99, 'recall99': 0.0}
Round 2:
{'auc': 0.6225495393463296, 'accuracy': 0.9520434679896055, 'precision': 0.757847533632287, 'recall': 0.5314465408805031, 'f1': 0.6247689463955638, 'fp': 54, 'tp': 169, 'fn': 149, 'tn': 3861, 'auprc': 0.5590172821507615, 'precision99': 0.99, 'recall99': 0.0}
Round 3:
{'auc': 0.6370759937990473, 'accuracy': 0.9546420978029766, 'precision': 0.7787610619469026, 'recall': 0.5534591194968553, 'f1': 0.6470588235294117, 'fp': 50, 'tp': 176, 'fn': 142, 'tn': 3865, 'auprc': 0.5369234974494997, 'precision99': 0.99, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.04147744474719951
proportion of infection events tagged by ps-detector-recon detector:  0.4827934201231204
proportion of infection events tagged by ps-detector-infec detector:  0.41613684529215866
proportion of events estimated to be benign :  0.06857402361489555
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model_4"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_22 (LSTM)                  [(None, 10, 128), (N 68096       input_9[0][0]                    
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 128)          512         lstm_22[0][1]                    
__________________________________________________________________________________________________
repeat_vector_4 (RepeatVector)  (None, 10, 128)      0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 128)          512         lstm_22[0][2]                    
__________________________________________________________________________________________________
lstm_23 (LSTM)                  (None, 10, 128)      131584      repeat_vector_4[0][0]            
                                                                 batch_normalization_12[0][0]     
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
dot_8 (Dot)                     (None, 10, 10)       0           lstm_23[0][0]                    
                                                                 lstm_22[0][0]                    
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 10, 10)       0           dot_8[0][0]                      
__________________________________________________________________________________________________
dot_9 (Dot)                     (None, 10, 128)      0           activation_8[0][0]               
                                                                 lstm_22[0][0]                    
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 10, 128)      512         dot_9[0][0]                      
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 10, 256)      0           batch_normalization_14[0][0]     
                                                                 lstm_23[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 10, 1)        257         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 10, 1)        0           time_distributed_4[0][0]         
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 11s - loss: 0.0575 - accuracy: 0.9859 - auc_11: 0.9956 - recall_11: 0.9851 - precision_11: 0.9868 - val_loss: 0.0354 - val_accuracy: 0.9917 - val_auc_11: 0.9967 - val_recall_11: 0.9939 - val_precision_11: 0.9897
Epoch 2/30
159/159 - 5s - loss: 0.0331 - accuracy: 0.9927 - auc_11: 0.9972 - recall_11: 0.9929 - precision_11: 0.9925 - val_loss: 0.0461 - val_accuracy: 0.9908 - val_auc_11: 0.9970 - val_recall_11: 0.9951 - val_precision_11: 0.9867
Epoch 3/30
159/159 - 5s - loss: 0.0294 - accuracy: 0.9933 - auc_11: 0.9976 - recall_11: 0.9931 - precision_11: 0.9935 - val_loss: 0.0370 - val_accuracy: 0.9911 - val_auc_11: 0.9972 - val_recall_11: 0.9942 - val_precision_11: 0.9882
Epoch 4/30
159/159 - 5s - loss: 0.0285 - accuracy: 0.9937 - auc_11: 0.9978 - recall_11: 0.9933 - precision_11: 0.9941 - val_loss: 0.0321 - val_accuracy: 0.9920 - val_auc_11: 0.9976 - val_recall_11: 0.9944 - val_precision_11: 0.9896
Epoch 5/30
159/159 - 5s - loss: 0.0287 - accuracy: 0.9933 - auc_11: 0.9976 - recall_11: 0.9928 - precision_11: 0.9938 - val_loss: 0.0364 - val_accuracy: 0.9916 - val_auc_11: 0.9972 - val_recall_11: 0.9941 - val_precision_11: 0.9892
Epoch 6/30
159/159 - 5s - loss: 0.0279 - accuracy: 0.9937 - auc_11: 0.9979 - recall_11: 0.9930 - precision_11: 0.9944 - val_loss: 0.0463 - val_accuracy: 0.9875 - val_auc_11: 0.9964 - val_recall_11: 0.9962 - val_precision_11: 0.9793
Epoch 7/30
159/159 - 5s - loss: 0.0277 - accuracy: 0.9938 - auc_11: 0.9979 - recall_11: 0.9930 - precision_11: 0.9945 - val_loss: 0.0505 - val_accuracy: 0.9820 - val_auc_11: 0.9986 - val_recall_11: 0.9970 - val_precision_11: 0.9680
Epoch 8/30
159/159 - 5s - loss: 0.0625 - accuracy: 0.9932 - auc_11: 0.9975 - recall_11: 0.9931 - precision_11: 0.9933 - val_loss: 0.0314 - val_accuracy: 0.9922 - val_auc_11: 0.9989 - val_recall_11: 0.9928 - val_precision_11: 0.9917
Epoch 9/30
159/159 - 5s - loss: 0.0276 - accuracy: 0.9937 - auc_11: 0.9980 - recall_11: 0.9930 - precision_11: 0.9943 - val_loss: 0.0307 - val_accuracy: 0.9921 - val_auc_11: 0.9971 - val_recall_11: 0.9931 - val_precision_11: 0.9912
Epoch 10/30
159/159 - 5s - loss: 0.0263 - accuracy: 0.9940 - auc_11: 0.9981 - recall_11: 0.9928 - precision_11: 0.9951 - val_loss: 0.0339 - val_accuracy: 0.9923 - val_auc_11: 0.9986 - val_recall_11: 0.9929 - val_precision_11: 0.9917
Epoch 11/30
159/159 - 5s - loss: 0.0264 - accuracy: 0.9940 - auc_11: 0.9981 - recall_11: 0.9933 - precision_11: 0.9946 - val_loss: 0.0285 - val_accuracy: 0.9925 - val_auc_11: 0.9989 - val_recall_11: 0.9934 - val_precision_11: 0.9916
Epoch 12/30
159/159 - 5s - loss: 0.0254 - accuracy: 0.9941 - auc_11: 0.9982 - recall_11: 0.9930 - precision_11: 0.9952 - val_loss: 0.0300 - val_accuracy: 0.9917 - val_auc_11: 0.9989 - val_recall_11: 0.9946 - val_precision_11: 0.9890
Epoch 13/30
159/159 - 5s - loss: 0.0273 - accuracy: 0.9935 - auc_11: 0.9982 - recall_11: 0.9931 - precision_11: 0.9939 - val_loss: 0.1156 - val_accuracy: 0.9637 - val_auc_11: 0.9964 - val_recall_11: 0.9939 - val_precision_11: 0.9374
Epoch 14/30
159/159 - 5s - loss: 0.0290 - accuracy: 0.9934 - auc_11: 0.9981 - recall_11: 0.9927 - precision_11: 0.9940 - val_loss: 0.0348 - val_accuracy: 0.9916 - val_auc_11: 0.9989 - val_recall_11: 0.9949 - val_precision_11: 0.9884
Epoch 15/30
159/159 - 5s - loss: 0.0262 - accuracy: 0.9937 - auc_11: 0.9981 - recall_11: 0.9932 - precision_11: 0.9941 - val_loss: 0.0301 - val_accuracy: 0.9923 - val_auc_11: 0.9990 - val_recall_11: 0.9936 - val_precision_11: 0.9911
Epoch 16/30
159/159 - 5s - loss: 0.0249 - accuracy: 0.9941 - auc_11: 0.9983 - recall_11: 0.9931 - precision_11: 0.9950 - val_loss: 0.0282 - val_accuracy: 0.9921 - val_auc_11: 0.9990 - val_recall_11: 0.9941 - val_precision_11: 0.9902
Epoch 17/30
159/159 - 5s - loss: 0.0270 - accuracy: 0.9937 - auc_11: 0.9981 - recall_11: 0.9927 - precision_11: 0.9947 - val_loss: 0.0377 - val_accuracy: 0.9910 - val_auc_11: 0.9972 - val_recall_11: 0.9950 - val_precision_11: 0.9871
Epoch 18/30
159/159 - 5s - loss: 0.0257 - accuracy: 0.9938 - auc_11: 0.9984 - recall_11: 0.9928 - precision_11: 0.9947 - val_loss: 0.0359 - val_accuracy: 0.9915 - val_auc_11: 0.9991 - val_recall_11: 0.9950 - val_precision_11: 0.9881
Epoch 19/30
159/159 - 5s - loss: 0.0253 - accuracy: 0.9938 - auc_11: 0.9984 - recall_11: 0.9928 - precision_11: 0.9948 - val_loss: 0.0294 - val_accuracy: 0.9921 - val_auc_11: 0.9986 - val_recall_11: 0.9933 - val_precision_11: 0.9911
Epoch 20/30
159/159 - 5s - loss: 0.0245 - accuracy: 0.9941 - auc_11: 0.9984 - recall_11: 0.9931 - precision_11: 0.9952 - val_loss: 0.0379 - val_accuracy: 0.9908 - val_auc_11: 0.9970 - val_recall_11: 0.9951 - val_precision_11: 0.9866
Epoch 21/30
159/159 - 5s - loss: 0.0250 - accuracy: 0.9939 - auc_11: 0.9984 - recall_11: 0.9930 - precision_11: 0.9949 - val_loss: 0.0365 - val_accuracy: 0.9921 - val_auc_11: 0.9988 - val_recall_11: 0.9935 - val_precision_11: 0.9909
Epoch 22/30
159/159 - 5s - loss: 0.0248 - accuracy: 0.9941 - auc_11: 0.9984 - recall_11: 0.9930 - precision_11: 0.9951 - val_loss: 0.0283 - val_accuracy: 0.9930 - val_auc_11: 0.9987 - val_recall_11: 0.9918 - val_precision_11: 0.9942
Epoch 23/30
159/159 - 5s - loss: 0.0274 - accuracy: 0.9938 - auc_11: 0.9979 - recall_11: 0.9933 - precision_11: 0.9942 - val_loss: 0.0374 - val_accuracy: 0.9909 - val_auc_11: 0.9969 - val_recall_11: 0.9931 - val_precision_11: 0.9888
Epoch 24/30
159/159 - 5s - loss: 0.0251 - accuracy: 0.9940 - auc_11: 0.9983 - recall_11: 0.9927 - precision_11: 0.9953 - val_loss: 0.0288 - val_accuracy: 0.9928 - val_auc_11: 0.9987 - val_recall_11: 0.9923 - val_precision_11: 0.9932
Epoch 25/30
159/159 - 5s - loss: 0.0243 - accuracy: 0.9938 - auc_11: 0.9985 - recall_11: 0.9927 - precision_11: 0.9948 - val_loss: 0.0294 - val_accuracy: 0.9913 - val_auc_11: 0.9989 - val_recall_11: 0.9913 - val_precision_11: 0.9913
Epoch 26/30
159/159 - 5s - loss: 0.0248 - accuracy: 0.9939 - auc_11: 0.9983 - recall_11: 0.9927 - precision_11: 0.9951 - val_loss: 0.0296 - val_accuracy: 0.9926 - val_auc_11: 0.9984 - val_recall_11: 0.9931 - val_precision_11: 0.9923
Epoch 27/30
159/159 - 5s - loss: 0.0243 - accuracy: 0.9939 - auc_11: 0.9984 - recall_11: 0.9926 - precision_11: 0.9952 - val_loss: 0.0322 - val_accuracy: 0.9909 - val_auc_11: 0.9988 - val_recall_11: 0.9953 - val_precision_11: 0.9867
Epoch 28/30
159/159 - 5s - loss: 0.0236 - accuracy: 0.9939 - auc_11: 0.9986 - recall_11: 0.9924 - precision_11: 0.9954 - val_loss: 0.0305 - val_accuracy: 0.9918 - val_auc_11: 0.9971 - val_recall_11: 0.9946 - val_precision_11: 0.9892
Epoch 29/30
159/159 - 4s - loss: 0.0239 - accuracy: 0.9941 - auc_11: 0.9985 - recall_11: 0.9928 - precision_11: 0.9954 - val_loss: 0.0293 - val_accuracy: 0.9914 - val_auc_11: 0.9987 - val_recall_11: 0.9951 - val_precision_11: 0.9879
Epoch 30/30
159/159 - 4s - loss: 0.0245 - accuracy: 0.9940 - auc_11: 0.9984 - recall_11: 0.9928 - precision_11: 0.9952 - val_loss: 0.0377 - val_accuracy: 0.9907 - val_auc_11: 0.9966 - val_recall_11: 0.9902 - val_precision_11: 0.9912
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/20
558/558 - 4s - loss: 0.3700 - accuracy: 0.8530 - auc_12: 0.9004 - recall_12: 0.7944 - precision_12: 0.9039 - val_loss: 0.2907 - val_accuracy: 0.8824 - val_auc_12: 0.9287 - val_recall_12: 0.8008 - val_precision_12: 0.9565
Epoch 2/20
558/558 - 1s - loss: 0.2802 - accuracy: 0.8893 - auc_12: 0.9318 - recall_12: 0.8184 - precision_12: 0.9569 - val_loss: 0.2604 - val_accuracy: 0.8946 - val_auc_12: 0.9364 - val_recall_12: 0.8200 - val_precision_12: 0.9632
Epoch 3/20
558/558 - 1s - loss: 0.2626 - accuracy: 0.8962 - auc_12: 0.9357 - recall_12: 0.8226 - precision_12: 0.9677 - val_loss: 0.2740 - val_accuracy: 0.8814 - val_auc_12: 0.9376 - val_recall_12: 0.7786 - val_precision_12: 0.9796
Epoch 4/20
558/558 - 1s - loss: 0.2586 - accuracy: 0.8979 - auc_12: 0.9356 - recall_12: 0.8229 - precision_12: 0.9711 - val_loss: 0.2479 - val_accuracy: 0.8991 - val_auc_12: 0.9391 - val_recall_12: 0.8170 - val_precision_12: 0.9770
Epoch 5/20
558/558 - 1s - loss: 0.2559 - accuracy: 0.8993 - auc_12: 0.9368 - recall_12: 0.8236 - precision_12: 0.9736 - val_loss: 0.2498 - val_accuracy: 0.9021 - val_auc_12: 0.9378 - val_recall_12: 0.8150 - val_precision_12: 0.9865
Epoch 6/20
558/558 - 1s - loss: 0.2504 - accuracy: 0.9008 - auc_12: 0.9377 - recall_12: 0.8240 - precision_12: 0.9764 - val_loss: 0.2402 - val_accuracy: 0.9021 - val_auc_12: 0.9416 - val_recall_12: 0.8160 - val_precision_12: 0.9853
Epoch 7/20
558/558 - 1s - loss: 0.2506 - accuracy: 0.9011 - auc_12: 0.9377 - recall_12: 0.8236 - precision_12: 0.9777 - val_loss: 0.2435 - val_accuracy: 0.9026 - val_auc_12: 0.9410 - val_recall_12: 0.8210 - val_precision_12: 0.9807
Epoch 8/20
558/558 - 1s - loss: 0.2465 - accuracy: 0.9019 - auc_12: 0.9376 - recall_12: 0.8246 - precision_12: 0.9785 - val_loss: 0.2512 - val_accuracy: 0.8956 - val_auc_12: 0.9368 - val_recall_12: 0.8018 - val_precision_12: 0.9863
Epoch 9/20
558/558 - 1s - loss: 0.2456 - accuracy: 0.9029 - auc_12: 0.9383 - recall_12: 0.8242 - precision_12: 0.9810 - val_loss: 0.2347 - val_accuracy: 0.9057 - val_auc_12: 0.9418 - val_recall_12: 0.8220 - val_precision_12: 0.9867
Epoch 10/20
558/558 - 1s - loss: 0.2441 - accuracy: 0.9026 - auc_12: 0.9396 - recall_12: 0.8243 - precision_12: 0.9803 - val_loss: 0.2355 - val_accuracy: 0.9046 - val_auc_12: 0.9420 - val_recall_12: 0.8200 - val_precision_12: 0.9866
Epoch 11/20
558/558 - 1s - loss: 0.2435 - accuracy: 0.9036 - auc_12: 0.9392 - recall_12: 0.8251 - precision_12: 0.9816 - val_loss: 0.2502 - val_accuracy: 0.8981 - val_auc_12: 0.9395 - val_recall_12: 0.8079 - val_precision_12: 0.9852
Epoch 12/20
558/558 - 1s - loss: 0.2403 - accuracy: 0.9051 - auc_12: 0.9400 - recall_12: 0.8265 - precision_12: 0.9837 - val_loss: 0.2386 - val_accuracy: 0.9046 - val_auc_12: 0.9415 - val_recall_12: 0.8220 - val_precision_12: 0.9843
Epoch 13/20
558/558 - 1s - loss: 0.2427 - accuracy: 0.9037 - auc_12: 0.9389 - recall_12: 0.8247 - precision_12: 0.9823 - val_loss: 0.2397 - val_accuracy: 0.9011 - val_auc_12: 0.9417 - val_recall_12: 0.8160 - val_precision_12: 0.9829
Epoch 14/20
558/558 - 1s - loss: 0.2395 - accuracy: 0.9043 - auc_12: 0.9408 - recall_12: 0.8257 - precision_12: 0.9826 - val_loss: 0.2311 - val_accuracy: 0.9057 - val_auc_12: 0.9423 - val_recall_12: 0.8190 - val_precision_12: 0.9902
Epoch 15/20
558/558 - 1s - loss: 0.2411 - accuracy: 0.9041 - auc_12: 0.9387 - recall_12: 0.8248 - precision_12: 0.9832 - val_loss: 0.2371 - val_accuracy: 0.9046 - val_auc_12: 0.9418 - val_recall_12: 0.8220 - val_precision_12: 0.9843
Epoch 16/20
558/558 - 1s - loss: 0.2391 - accuracy: 0.9052 - auc_12: 0.9396 - recall_12: 0.8261 - precision_12: 0.9842 - val_loss: 0.2357 - val_accuracy: 0.9051 - val_auc_12: 0.9431 - val_recall_12: 0.8180 - val_precision_12: 0.9902
Epoch 17/20
558/558 - 1s - loss: 0.2385 - accuracy: 0.9054 - auc_12: 0.9402 - recall_12: 0.8265 - precision_12: 0.9842 - val_loss: 0.2409 - val_accuracy: 0.9046 - val_auc_12: 0.9423 - val_recall_12: 0.8190 - val_precision_12: 0.9878
Epoch 18/20
558/558 - 1s - loss: 0.2384 - accuracy: 0.9051 - auc_12: 0.9392 - recall_12: 0.8253 - precision_12: 0.9849 - val_loss: 0.2336 - val_accuracy: 0.9041 - val_auc_12: 0.9425 - val_recall_12: 0.8220 - val_precision_12: 0.9831
Epoch 19/20
558/558 - 1s - loss: 0.2374 - accuracy: 0.9059 - auc_12: 0.9406 - recall_12: 0.8263 - precision_12: 0.9856 - val_loss: 0.2494 - val_accuracy: 0.8865 - val_auc_12: 0.9421 - val_recall_12: 0.7836 - val_precision_12: 0.9860
Epoch 20/20
558/558 - 1s - loss: 0.2354 - accuracy: 0.9055 - auc_12: 0.9397 - recall_12: 0.8258 - precision_12: 0.9853 - val_loss: 0.2311 - val_accuracy: 0.9077 - val_auc_12: 0.9425 - val_recall_12: 0.8210 - val_precision_12: 0.9927
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.6303192044788228, 'accuracy': 0.9522797070635484, 'precision': 0.7612612612612613, 'recall': 0.5314465408805031, 'f1': 0.6259259259259259, 'fp': 53, 'tp': 169, 'fn': 149, 'tn': 3862, 'auprc': 0.4697101360027475, 'precision99': 0.96, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.635535394427175, 'accuracy': 0.9562957713205764, 'precision': 0.8036529680365296, 'recall': 0.5534591194968553, 'f1': 0.6554934823091247, 'fp': 43, 'tp': 176, 'fn': 142, 'tn': 3872, 'auprc': 0.5743173092792139, 'precision99': 0.99, 'recall99': 0.0}
Round 1:
{'auc': 0.6183293573339117, 'accuracy': 0.9489723600283487, 'precision': 0.7161016949152542, 'recall': 0.5314465408805031, 'f1': 0.6101083032490976, 'fp': 67, 'tp': 169, 'fn': 149, 'tn': 3848, 'auprc': 0.5148409229864762, 'precision99': 0.99, 'recall99': 0.0}
Round 2:
{'auc': 0.6225495393463296, 'accuracy': 0.9520434679896055, 'precision': 0.757847533632287, 'recall': 0.5314465408805031, 'f1': 0.6247689463955638, 'fp': 54, 'tp': 169, 'fn': 149, 'tn': 3861, 'auprc': 0.5590172821507615, 'precision99': 0.99, 'recall99': 0.0}
Round 3:
{'auc': 0.6370759937990473, 'accuracy': 0.9546420978029766, 'precision': 0.7787610619469026, 'recall': 0.5534591194968553, 'f1': 0.6470588235294117, 'fp': 50, 'tp': 176, 'fn': 142, 'tn': 3865, 'auprc': 0.5369234974494997, 'precision99': 0.99, 'recall99': 0.0}
Round 4:
{'auc': 0.6278251684779553, 'accuracy': 0.9548783368769195, 'precision': 0.7981220657276995, 'recall': 0.5345911949685535, 'f1': 0.6403013182674199, 'fp': 43, 'tp': 170, 'fn': 148, 'tn': 3872, 'auprc': 0.5432943459011229, 'precision99': 0.99, 'recall99': 0.0}
